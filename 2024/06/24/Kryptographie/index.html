<!DOCTYPE html><html lang="zh-CN" data-theme="darkmode"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>课程「应用密码学与网络安全」期末复习笔记 | 雨水磁浮的博客</title><meta name="author" content="K-PK66"><meta name="copyright" content="K-PK66"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本文是课程「应用密码学与网络安全」的2024年6月25日期末考前复习和实验报告的整合。  期末复习 引言 网络安全核心地位的关键目标是CIA3，即保密性confidentiality、完整性Integrity、可用性availability、真实性authenticity和可追溯性accountability。 实验报告 实验一 古典密码实验 实验目的：了解并掌握Caesar密码、仿射密码和单表">
<meta property="og:type" content="article">
<meta property="og:title" content="课程「应用密码学与网络安全」期末复习笔记">
<meta property="og:url" content="https://k-pk66.github.io/2024/06/24/Kryptographie/index.html">
<meta property="og:site_name" content="雨水磁浮的博客">
<meta property="og:description" content="本文是课程「应用密码学与网络安全」的2024年6月25日期末考前复习和实验报告的整合。  期末复习 引言 网络安全核心地位的关键目标是CIA3，即保密性confidentiality、完整性Integrity、可用性availability、真实性authenticity和可追溯性accountability。 实验报告 实验一 古典密码实验 实验目的：了解并掌握Caesar密码、仿射密码和单表">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://k-pk66.github.io/images/avatar.png">
<meta property="article:published_time" content="2024-06-23T16:51:40.000Z">
<meta property="article:modified_time" content="2024-06-24T07:27:56.921Z">
<meta property="article:author" content="K-PK66">
<meta property="article:tag" content="#复习记#">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://k-pk66.github.io/images/avatar.png"><link rel="shortcut icon" href="/images/minesweep.png"><link rel="canonical" href="https://k-pk66.github.io/2024/06/24/Kryptographie/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/k-pk66/k-pk66.github.io/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '课程「应用密码学与网络安全」期末复习笔记',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-06-24 15:27:56'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/my.css"><meta name="generator" content="Hexo 7.2.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

document.addEventListener('pjax:send', () => {
  Pace.restart()
})
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/images/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 留档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-hashtag"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a href="/" title="雨水磁浮的博客"><img class="site-icon" src="/images/minesweep.png"/><span class="site-name">雨水磁浮的博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 留档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-hashtag"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">课程「应用密码学与网络安全」期末复习笔记</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-06-23T16:51:40.000Z" title="发表于 2024-06-24 00:51:40">2024-06-24</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-06-24T07:27:56.921Z" title="更新于 2024-06-24 15:27:56">2024-06-24</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Review/">Review</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">12.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>56分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="课程「应用密码学与网络安全」期末复习笔记"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2024/06/24/Kryptographie/#post-comment"><span class="gitalk-comment-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
本文是课程「应用密码学与网络安全」的2024年6月25日期末考前复习和实验报告的整合。
</blockquote>
<h1>期末复习</h1>
<h2 id="引言">引言</h2>
<p>网络安全核心地位的关键目标是CIA3，即<ruby>保密性<rt>confidentiality</rt></ruby>、<ruby>完整性<rt>Integrity</rt></ruby>、<ruby>可用性<rt>availability</rt></ruby>、<ruby>真实性<rt>authenticity</rt></ruby>和<ruby>可追溯性<rt>accountability</rt></ruby>。</p>
<h1>实验报告</h1>
<h2 id="实验一-古典密码实验">实验一 古典密码实验</h2>
<p><strong>实验目的</strong>：了解并掌握Caesar密码、仿射密码和单表置换密码的加解密原理。</p>
<h3 id="Caesar密码">Caesar密码</h3>
<p>自选语言设计Caesar算法，并能任意指定英文字母组合和密钥对前者进行加密。</p>
<h4 id="实验原理">实验原理</h4>
<p>Caesar加密/解密是一种替换加密技术，明文中的所有字母都在字母表上向后（或向前）按照一个固定数目进行偏移后被替换成密文。例如，当偏移量是3的时候，明密文对照表可以如下所示：</p>
<table>
  <tr>
    <td>明文</td><td>ABCDEFGHIJKLMNOPQRSTUVWXYZ</td>
  </tr>
  <tr>
    <td>密文</td><td>DEFGHIJKLMNOPQRSTUVWXYZABC</td>
  </tr>
</table>
这种加密方式非常容易受到选取语言的制约。例如，当对英语体系进行加密时，选择的偏移量显然不能超过25。因此，即使使用唯密文攻击，凯撒密码也是一种非常容易破解的加密方式。
<h4 id="实验代码与运行记录">实验代码与运行记录</h4>
<h5 id="加密算法">加密算法</h5>
<p>显然根据实验原理中所描述的定义和思路不难得到凯撒密码的加密算法。为了区分英文字母的大小写，大写字母的加密结果会变为小写，而小写则会被加密为大写。</p>
<p>算法中暗含了一个隐形的“明密文对照表”。英文Caesar密码的解密过程本质上是将密文进行新一轮加密，只是发生了反向的偏移。换言之，加密的偏移量<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">k_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
和解密时的偏移量<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">k_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
在处理英文文本时显然有<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>k</mi><mi>d</mi></msub><mo>=</mo><mn>26</mn><mo>−</mo><msub><mi>k</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">k_d=26-k_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">26</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br>
。利用此即可通过语言<code>kotlin</code>得到如下所示的算法代码。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">caesarCipher</span><span class="params">(text:<span class="type">String</span>, key:<span class="type">Int</span>, decryptMode:<span class="type">Boolean</span>)</span></span>: String &#123;</span><br><span class="line">    <span class="keyword">val</span> newKey=<span class="keyword">when</span>(decryptMode)&#123;</span><br><span class="line">        <span class="literal">true</span> -&gt; <span class="number">26</span>-key</span><br><span class="line">        <span class="keyword">else</span> -&gt; key</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">val</span> textChars=text.toCharArray()</span><br><span class="line">    <span class="keyword">val</span> ansChars=CharArray(textChars.size)</span><br><span class="line">    <span class="keyword">for</span>(i <span class="keyword">in</span> textChars.indices)&#123;</span><br><span class="line">        <span class="keyword">if</span>(textChars[i] <span class="keyword">in</span> <span class="string">&#x27;A&#x27;</span>..<span class="string">&#x27;Z&#x27;</span>)&#123;</span><br><span class="line">            ansChars[i] = ((textChars[i].code-<span class="string">&#x27;A&#x27;</span>.code+newKey)%<span class="number">26</span>+<span class="string">&#x27;a&#x27;</span>.code).toChar()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(textChars[i] <span class="keyword">in</span> <span class="string">&#x27;a&#x27;</span>..<span class="string">&#x27;z&#x27;</span>)&#123;</span><br><span class="line">            ansChars[i] = ((textChars[i].code-<span class="string">&#x27;a&#x27;</span>.code+newKey)%<span class="number">26</span>+<span class="string">&#x27;A&#x27;</span>.code).toChar()</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ansChars[i]=textChars[i]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> String(ansChars)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="运行结果">运行结果</h5>
<p>对该算法代码设计主程序的输入、输出。随后运行该程序；以加密时偏移量为5，并对文本“<code>Hello</code>”进行加密的情况为例，运行结果如下所示。</p>
<p><img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/CaesarSS.png"></img></p>
<p><img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/CaesarSS2.png"></img></p>
<p>显然解密结果与原本的明文一致。</p>
<h3 id="仿射密码">仿射密码</h3>
<p>自选语言设计算法，使该算法能够对任意英文字母组合和密钥进行仿射加密。</p>
<h4 id="实验原理-2">实验原理</h4>
<p>仿射密码本质上与Caesar密码类似，也是一种替代加密技术。对总字母数量为<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span><br>
的语言体系中的任意字母<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span><br>
，其加密后的结果<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><br>
满足<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mspace></mspace><mspace width="0.4444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e(x)=ax+b\pmod{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span><br>
，其中<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span><br>
是与<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span><br>
互质的任意值，<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span><br>
是任意值。</p>
<p>与加密函数相对应地，解密函数为<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>b</mi><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.4444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d(x)=a^{-1}(x-b)\pmod{m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span><br>
，其中<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">a^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><br>
是<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span><br>
的一个取模倒数。</p>
<p>显然可以通过等式</p>
<p>\begin{align}
\mbox{D}(\mbox{E}(x)) &= a^{-1}(\mbox{E}(x)-b)\mod{m}\\
&= a^{-1}(((ax+b)\mod{m})-b)\mod{m} \\
&= a^{-1}(ax+b-b)\mod{m} \\
&= a^{-1}ax \mod{m}\\
&= x\mod{m}.
\end{align}
</p>
<p>证明加密结果的解密结果就是原文本身。</p>
<h4 id="实验代码与运行记录-2">实验代码与运行记录</h4>
<h5 id="算法代码">算法代码</h5>
<p>根据上方定义不难得到仿射加解密的算法。在讨论算法之前，首先要对算法中等式的一部分参数进行设计。</p>
<h6 id="互质">互质</h6>
<p>需要确保<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span><br>
与<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span><br>
互质。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">isPrior</span><span class="params">(a:<span class="type">Int</span>,b:<span class="type">Int</span>)</span></span>:<span class="built_in">Boolean</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(a==<span class="number">1</span>||b==<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">    <span class="keyword">var</span> realA=a</span><br><span class="line">    <span class="keyword">var</span> realB=b</span><br><span class="line">    <span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">val</span> t = realA % realB</span><br><span class="line">        <span class="keyword">if</span>(t == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            realA = realB</span><br><span class="line">            realB = t</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> realB &lt;= <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="取模倒数（乘法逆元）">取模倒数（乘法逆元）</h6>
<p>生成<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span><br>
的取模倒数<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>a</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">a^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><br>
；此值应能确保与<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span><br>
的乘积对<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span><br>
的求余结果为1。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">inverseGenerator</span><span class="params">(a:<span class="type">Int</span>,m:<span class="type">Int</span>)</span></span>:<span class="built_in">Int</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> result=<span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> i=<span class="number">0</span></span><br><span class="line">    <span class="keyword">do</span>&#123;</span><br><span class="line">        i++</span><br><span class="line">        <span class="keyword">if</span>(a*i%m==<span class="number">1</span>)&#123;</span><br><span class="line">            result=i</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">while</span>(<span class="literal">true</span>)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h6 id="加密">加密</h6>
<p>由于是英文字母分大小写总共52个，故不妨令<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>53</mn></mrow><annotation encoding="application/x-tex">m=53</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">53</span></span></span></span><br>
。在这之后先生成一个暗含的明密文对照表<code>cipherSheet</code>，再根据此表通过<code>ReferenceForIndex</code>对每一个给定的字符查找到该字符在表中所对应的索引；类似地，再通过<code>cipherSheetReferenceForChar</code>可以找到特定索引号在表内所对应的字符。之后根据上述所有函数利用定义即可用<code>kotlin</code>写出算法代码如下所示。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> cipherSheet=CharArray(<span class="number">55</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">cipherSheetReferenceForIndex</span><span class="params">(c:<span class="type">Char</span>)</span></span>:<span class="built_in">Int</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(c <span class="keyword">in</span> <span class="string">&#x27;a&#x27;</span>..<span class="string">&#x27;z&#x27;</span>) <span class="keyword">return</span> c.code-<span class="string">&#x27;a&#x27;</span>.code+<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span>(c <span class="keyword">in</span> <span class="string">&#x27;A&#x27;</span>..<span class="string">&#x27;Z&#x27;</span>) <span class="keyword">return</span> c.code-<span class="string">&#x27;A&#x27;</span>.code+<span class="number">27</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">cipherSheetReferenceForChar</span><span class="params">(i:<span class="type">Int</span>)</span></span>:<span class="built_in">Char</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> cipherSheet[i]</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">affineCipher</span><span class="params">(text:<span class="type">String</span>,a:<span class="type">Int</span>,b:<span class="type">Int</span>,m:<span class="type">Int</span>,decryptMode:<span class="type">Boolean</span>)</span></span>:String&#123;</span><br><span class="line">    <span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">0</span> until <span class="number">26</span>)&#123;</span><br><span class="line">        cipherSheet[i+<span class="number">1</span>]=(i+<span class="string">&#x27;a&#x27;</span>.code).toChar()</span><br><span class="line">        cipherSheet[i+<span class="number">27</span>]=(i+<span class="string">&#x27;A&#x27;</span>.code).toChar()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">val</span> textChars=text.toCharArray()</span><br><span class="line">    <span class="keyword">val</span> ansChars=CharArray(textChars.size)</span><br><span class="line">    <span class="keyword">for</span>(i <span class="keyword">in</span> text.indices)&#123;</span><br><span class="line">        <span class="keyword">val</span> n = cipherSheetReferenceForIndex(text[i])</span><br><span class="line">        <span class="keyword">if</span>(n!=-<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">val</span> index = <span class="keyword">when</span>(decryptMode) &#123;</span><br><span class="line">                <span class="literal">true</span>-&gt;(inverseGenerator(a,m) * (n - b + m)) % m</span><br><span class="line">                <span class="keyword">else</span>-&gt;(a*n+b)%m</span><br><span class="line">            &#125;</span><br><span class="line">            ansChars[i]=cipherSheetReferenceForChar(index)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            ansChars[i]=textChars[i]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> String(ansChars)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="运行结果-2">运行结果</h5>
<p>根据算法代码设计输入输出，并运行该程序。以利用<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>=</mo><mn>91</mn><mo separator="true">,</mo><mi>b</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">a=91,b=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">91</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span><br>
对明文“<code>Hello</code>”进行加解密为例，得到的结果如下所示：</p>
<p><img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/affineSS1.png"></img></p>
<p><img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/affineSS2.png"></img></p>
<p>可以看到，解密的结果与原本的明文一致。</p>
<h3 id="单表置换加密">单表置换加密</h3>
<p>自选语言设计算法，使该算法可以对文本进行单表置换加解密。</p>
<h4 id="实验原理-3">实验原理</h4>
<p>单表置换加密本质上是一种置换式加密；与替代式加密的不同之处在于，其可以通过打乱明文（通常是字符或字符组）中的各字符所处的相对位置而实现加密，并在打乱后生成文本密文。在没有密钥的情况下，生成的消息极难破译，因为字符有意义的排列方式可以有很多种。</p>
<p>单表置换加密算法中维护着一个置换表，其中记录了明文和密文的对照关系。在没有加密（即没有发生置换）之前，其置换表可以如下。</p>
<table>
  <tr>
    <td>明文</td><td>a</td><td>b</td><td>c</td><td>d</td><td>e</td><td>f</td><td>g</td><td>h</td><td>i</td><td>j</td><td>k</td><td>l</td><td>m</td>
  </tr>
  <tr>
    <td>密文</td><td>a</td><td>b</td><td>c</td><td>d</td><td>e</td><td>f</td><td>g</td><td>h</td><td>i</td><td>j</td><td>k</td><td>l</td><td>m</td>
  </tr>
  <tr>
    <td>明文</td><td>n</td><td>o</td><td>p</td><td>q</td><td>r</td><td>s</td><td>t</td><td>u</td><td>v</td><td>w</td><td>x</td><td>y</td><td>z</td>
  </tr>
  <tr>
    <td>密文</td><td>n</td><td>o</td><td>p</td><td>q</td><td>r</td><td>s</td><td>t</td><td>u</td><td>v</td><td>w</td><td>x</td><td>y</td><td>z</td>
  </tr>
  <tr>
    <td>明文</td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td><td>M</td>
  </tr>
  <tr>
    <td>密文</td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td><td>M</td>
  </tr>
  <tr>
    <td>明文</td><td>N</td><td>O</td><td>P</td><td>Q</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td>
  </tr>
  <tr>
    <td>密文</td><td>N</td><td>O</td><td>P</td><td>Q</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td>
  </tr>
</table>
<p>在设定密钥为“<code>Munich</code>”后，置换表将发生改变；改变后的结果如下。</p>
<table>
  <tr>
    <td>明文</td><td>a</td><td>b</td><td>c</td><td>d</td><td>e</td><td>f</td><td>g</td><td>h</td><td>i</td><td>j</td><td>k</td><td>l</td><td>m</td>
  </tr>
  <tr>
    <td>密文</td><td>m</td><td>u</td><td>n</td><td>i</td><td>c</td><td>h</td><td>a</td><td>b</td><td>d</td><td>e</td><td>f</td><td>g</td><td>j</td>
  </tr>
  <tr>
    <td>明文</td><td>n</td><td>o</td><td>p</td><td>q</td><td>r</td><td>s</td><td>t</td><td>u</td><td>v</td><td>w</td><td>x</td><td>y</td><td>z</td>
  </tr>
  <tr>
    <td>密文</td><td>k</td><td>l</td><td>o</td><td>p</td><td>q</td><td>r</td><td>s</td><td>t</td><td>v</td><td>w</td><td>x</td><td>y</td><td>z</td>
  </tr>
  <tr>
    <td>明文</td><td>A</td><td>B</td><td>C</td><td>D</td><td>E</td><td>F</td><td>G</td><td>H</td><td>I</td><td>J</td><td>K</td><td>L</td><td>M</td>
  </tr>
  <tr>
    <td>密文</td><td>M</td><td>U</td><td>N</td><td>I</td><td>C</td><td>H</td><td>A</td><td>B</td><td>D</td><td>E</td><td>F</td><td>G</td><td>J</td>
  </tr>
  <tr>
    <td>明文</td><td>N</td><td>O</td><td>P</td><td>Q</td><td>R</td><td>S</td><td>T</td><td>U</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td>
  </tr>
  <tr>
    <td>密文</td><td>K</td><td>L</td><td>O</td><td>P</td><td>Q</td><td>R</td><td>S</td><td>T</td><td>V</td><td>W</td><td>X</td><td>Y</td><td>Z</td>
  </tr>
</table>
<p>比较后不难看出两置换表之间的区别。选用的密钥“<code>Munich</code>”将小写字母置换表区域中的<code>m</code>、<code>u</code>、<code>n</code>、<code>i</code>、<code>c</code>、<code>h</code>按密钥中的顺序提前至首位，剩余的未出现在密钥中的字母按字母表顺序排列在小写字母置换表中的剩余位置。大写字母置换表区域与其一致。</p>
<h4 id="实验代码与运行记录-3">实验代码与运行记录</h4>
<h5 id="算法代码-2">算法代码</h5>
<p>和仿射加密类似，算法中暗含了一个加密对照表和一个解密对照表。在加解密的过程中，只要通过对字符查找索引和根据索引查找字符即可实现置换。据此可以通过<code>kotlin</code>写出算法如下。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> encryptSheet= IntArray(<span class="number">30</span>)</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">val</span> decryptSheet= IntArray(<span class="number">30</span>)</span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">sheetReferenceForIndex</span><span class="params">(c:<span class="type">Char</span>)</span></span>:<span class="built_in">Int</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (c <span class="keyword">in</span> <span class="string">&#x27;a&#x27;</span>..<span class="string">&#x27;z&#x27;</span>) <span class="keyword">return</span> c.code-<span class="string">&#x27;a&#x27;</span>.code</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">if</span> (c <span class="keyword">in</span> <span class="string">&#x27;A&#x27;</span>..<span class="string">&#x27;Z&#x27;</span>) c.code-<span class="string">&#x27;A&#x27;</span>.code</span><br><span class="line">    <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">singleTableCipher</span><span class="params">(text:<span class="type">String</span>,key:<span class="type">String</span>,decryptMode:<span class="type">Boolean</span>)</span></span>:String&#123;</span><br><span class="line">    <span class="keyword">val</span> flags=IntArray(<span class="number">30</span>)&#123;_-&gt;<span class="number">0</span>&#125;</span><br><span class="line">    <span class="keyword">var</span> k=<span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span>(i <span class="keyword">in</span> key.indices)&#123;</span><br><span class="line">        <span class="keyword">var</span> n = sheetReferenceForIndex(key[i])</span><br><span class="line">        <span class="keyword">if</span>(flags[n] == <span class="number">0</span>)&#123;</span><br><span class="line">            encryptSheet[k++]=n</span><br><span class="line">            decryptSheet[n]=k-<span class="number">1</span></span><br><span class="line">            flags[n]=<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i <span class="keyword">in</span> <span class="number">0.</span>.&lt;<span class="number">26</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(flags[i] == <span class="number">0</span>)&#123;</span><br><span class="line">            encryptSheet[k++]=i</span><br><span class="line">            decryptSheet[i]=k-<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">val</span> textLen=text.length</span><br><span class="line">    <span class="keyword">val</span> ansChars=CharArray(textLen)</span><br><span class="line">    <span class="keyword">for</span>(i <span class="keyword">in</span> text.indices)&#123;</span><br><span class="line">        <span class="keyword">if</span>(text[i] <span class="keyword">in</span> <span class="string">&#x27;a&#x27;</span> .. <span class="string">&#x27;z&#x27;</span>) ansChars[i] = (<span class="keyword">when</span>(decryptMode)&#123;</span><br><span class="line">            <span class="literal">true</span>-&gt;decryptSheet[text[i].code-<span class="string">&#x27;a&#x27;</span>.code]</span><br><span class="line">            <span class="keyword">else</span>-&gt;encryptSheet[text[i].code-<span class="string">&#x27;a&#x27;</span>.code]</span><br><span class="line">        &#125;+<span class="string">&#x27;a&#x27;</span>.code).toChar()</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(text[i] <span class="keyword">in</span> <span class="string">&#x27;A&#x27;</span>..<span class="string">&#x27;Z&#x27;</span>) ansChars[i]=(<span class="keyword">when</span>(decryptMode)&#123;</span><br><span class="line">            <span class="literal">true</span>-&gt;decryptSheet[text[i].code-<span class="string">&#x27;A&#x27;</span>.code]</span><br><span class="line">            <span class="keyword">else</span>-&gt;encryptSheet[text[i].code-<span class="string">&#x27;A&#x27;</span>.code]</span><br><span class="line">        &#125;+<span class="string">&#x27;A&#x27;</span>.code).toChar()</span><br><span class="line">        <span class="keyword">else</span> ansChars[i]=text[i]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> String(ansChars)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="运行结果-3">运行结果</h5>
<p>根据上述算法设计输入输出。以采取密钥“<code>Munich</code>”对明文“<code>Berlin</code>”进行加解密为例，可以得到运行结果如下所示。</p>
<p><img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/saSS1.png"></img></p>
<p><img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/saSS2.png"></img></p>
<p>显然，解密结果和原本的明文一致。</p>
<h3 id="实验心得">实验心得</h3>
<p>古典密码学的各种加密都是通过简单的表内对照或基本运算实现的。也正是因此，这些加密算法都非常容易被破解；只有密钥相对复杂的置换式加密才有可能存在破译难度。</p>
<p>算法的编写过程中完全根据定义就能写出，没有遇到什么困难——这也比较符合这些密码广为使用时的实际场景。</p>
<h2 id="实验二-对称密钥加密（DES）实验">实验二 对称密钥加密（DES）实验</h2>
<p><strong>实验目的</strong>：了解并掌握DES加密的基本思路和加密算法。</p>
<p><strong>实验内容</strong>：自行选取语言编写算法，使该算法在不使用该语言自带的加密库的情况下能够对给定文本进行加解密。</p>
<h3 id="实验原理-4">实验原理</h3>
<p>数据加密标准（英语：Data Encryption Standard，缩写为DES）是一种基于使用56位密钥的对称密钥加密算法，1976年被美国联邦政府的国家标准局确定为联邦资料处理标准（FIPS），随后在国际上受到广泛使用。算法的整体结构中有16次相同的循环处理过程；在主处理这些循环之前，待加密的文本会被分成两个32位的半块后分别处理；这种交叉的方式也被称为Fiestel结构。Fiestel结构保证了加解密过程的相似度，唯一的区别在于子密钥在解密时是应用顺序与加密时相反。</p>
<p>在对这两个32位的半块做处理时主要包含以下四个步骤：</p>
<ol>
<li><strong>扩张</strong>：用扩张置换将32位的半块扩展到48位，其输出包括8个6位的块，每块包含4位对应的输入位，加上两个邻接的块中紧邻的位。</li>
<li><strong>密钥混合</strong>：用异或操作将扩张的结果和16个48位的子密钥中的每一个进行混合；这些子密钥都是利用密钥调度从主密钥生成的。</li>
<li><strong>S盒</strong>：在与子密钥混合之后，块被分成8个6位的块，然后使用“S盒”（或称“置换盒”）进行处理。8个S盒的每一个都使用以查找表方式提供的非线性的变换将它的6个输入位变成4个输出位。</li>
<li><strong>置换</strong>：将S盒的32个输出位利用固定的“P置换”进行重组，从而将每个S盒的4位输出在下一次循环中的扩张步骤时使用4个不同的S盒进行处理。</li>
</ol>
<p>在上方密钥混合步骤中所提到的“密钥调度”主要先使用选择置换1（PC-1）从64位输入密钥中选出56位的密钥。剩下的8位要么直接丢弃，要么作为奇偶校验位。然后，56位分成两个28位的半密钥；每个半密钥接下来都被分别处理。在接下来的每次循环中，两个半密钥都被左移1或2位（由循环次数数决定），然后通过选择置换2（PC-2）产生48位的子密钥——每个半密钥24位。移位表明每个子密钥中使用了不同的位；每个位大致在16个子密钥出现14次。</p>
<p>处理之后将结果与另一个半块异或。在此之后将得到的结果与原本的半块组合并交换顺序，进入下一次循环。在最后一次循环完成时，两个半块需要交换顺序。</p>
<h3 id="实验代码与运行结果">实验代码与运行结果</h3>
<h4 id="算法代码-3">算法代码</h4>
<p>根据上述定义利用<code>python</code>语言作代码如下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 淫趴矩阵（imperative matrix）</span></span><br><span class="line"><span class="comment"># 这些矩阵使用时下标要减一</span></span><br><span class="line"><span class="comment"># IP置换作用于进行16轮f函数作用之前，IP逆置换作用于16轮f函数作用之后</span></span><br><span class="line"><span class="comment"># IP置换表</span></span><br><span class="line"></span><br><span class="line">IP_table = [<span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">2</span>,</span><br><span class="line">            <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span>,</span><br><span class="line">            <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">6</span>,</span><br><span class="line">            <span class="number">64</span>, <span class="number">56</span>, <span class="number">48</span>, <span class="number">40</span>, <span class="number">32</span>, <span class="number">24</span>, <span class="number">16</span>, <span class="number">8</span>,</span><br><span class="line">            <span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>, <span class="number">1</span>,</span><br><span class="line">            <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>, <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>,</span><br><span class="line">            <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>, <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>,</span><br><span class="line">            <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>, <span class="number">7</span></span><br><span class="line">            ]</span><br><span class="line"><span class="comment"># 逆IP置换表</span></span><br><span class="line">_IP_table = [<span class="number">40</span>, <span class="number">8</span>, <span class="number">48</span>, <span class="number">16</span>, <span class="number">56</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">32</span>,</span><br><span class="line">             <span class="number">39</span>, <span class="number">7</span>, <span class="number">47</span>, <span class="number">15</span>, <span class="number">55</span>, <span class="number">23</span>, <span class="number">63</span>, <span class="number">31</span>,</span><br><span class="line">             <span class="number">38</span>, <span class="number">6</span>, <span class="number">46</span>, <span class="number">14</span>, <span class="number">54</span>, <span class="number">22</span>, <span class="number">62</span>, <span class="number">30</span>,</span><br><span class="line">             <span class="number">37</span>, <span class="number">5</span>, <span class="number">45</span>, <span class="number">13</span>, <span class="number">53</span>, <span class="number">21</span>, <span class="number">61</span>, <span class="number">29</span>,</span><br><span class="line">             <span class="number">36</span>, <span class="number">4</span>, <span class="number">44</span>, <span class="number">12</span>, <span class="number">52</span>, <span class="number">20</span>, <span class="number">60</span>, <span class="number">28</span>,</span><br><span class="line">             <span class="number">35</span>, <span class="number">3</span>, <span class="number">43</span>, <span class="number">11</span>, <span class="number">51</span>, <span class="number">19</span>, <span class="number">59</span>, <span class="number">27</span>,</span><br><span class="line">             <span class="number">34</span>, <span class="number">2</span>, <span class="number">42</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">18</span>, <span class="number">58</span>, <span class="number">26</span>,</span><br><span class="line">             <span class="number">33</span>, <span class="number">1</span>, <span class="number">41</span>, <span class="number">9</span>, <span class="number">49</span>, <span class="number">17</span>, <span class="number">57</span>, <span class="number">25</span></span><br><span class="line">             ]</span><br><span class="line"><span class="comment"># 每一个S-盒的输入数据是6位，输出数据是4位，但是每个S-盒自身是64位</span></span><br><span class="line"><span class="comment"># 设入的六位为b1,b2,b3,b4,b5,b6，b1、b6位组合得到列号，b2,b3,b4,b5组合得到行号。</span></span><br><span class="line"><span class="comment"># S盒中的S1盒</span></span><br><span class="line">S1 = [<span class="number">14</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">8</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">7</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">4</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>,</span><br><span class="line">      <span class="number">15</span>, <span class="number">12</span>, <span class="number">8</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">13</span></span><br><span class="line">      ]</span><br><span class="line"><span class="comment"># S盒中的S2盒</span></span><br><span class="line">S2 = [<span class="number">15</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>,</span><br><span class="line">      <span class="number">3</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">5</span>,</span><br><span class="line">      <span class="number">0</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">15</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">9</span></span><br><span class="line">      ]</span><br><span class="line"><span class="comment"># S盒中的S3盒</span></span><br><span class="line">S3 = [<span class="number">10</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">1</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">7</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">12</span></span><br><span class="line">      ]</span><br><span class="line"><span class="comment"># S盒中的S4盒</span></span><br><span class="line">S4 = [<span class="number">7</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">15</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">      <span class="number">10</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>,</span><br><span class="line">      <span class="number">3</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">2</span>, <span class="number">14</span></span><br><span class="line">      ]</span><br><span class="line"><span class="comment"># S盒中的S5盒</span></span><br><span class="line">S5 = [<span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>,</span><br><span class="line">      <span class="number">14</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">13</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">11</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">14</span>,</span><br><span class="line">      <span class="number">11</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">7</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">13</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">3</span></span><br><span class="line">      ]</span><br><span class="line"><span class="comment"># S盒中的S6盒</span></span><br><span class="line">S6 = [<span class="number">12</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">11</span>,</span><br><span class="line">      <span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">9</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span></span><br><span class="line">      ]</span><br><span class="line"><span class="comment"># S盒中的S7盒</span></span><br><span class="line">S7 = [<span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">3</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">6</span>, <span class="number">1</span>,</span><br><span class="line">      <span class="number">13</span>, <span class="number">0</span>, <span class="number">11</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">2</span>, <span class="number">15</span>, <span class="number">8</span>, <span class="number">6</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">      <span class="number">6</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">12</span></span><br><span class="line">      ]</span><br><span class="line"><span class="comment"># S盒中的S8盒</span></span><br><span class="line">S8 = [<span class="number">13</span>, <span class="number">2</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">15</span>, <span class="number">11</span>, <span class="number">1</span>, <span class="number">10</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">7</span>,</span><br><span class="line">      <span class="number">1</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">12</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">9</span>, <span class="number">2</span>,</span><br><span class="line">      <span class="number">7</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">14</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">8</span>,</span><br><span class="line">      <span class="number">2</span>, <span class="number">1</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">10</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">11</span></span><br><span class="line">      ]</span><br><span class="line"><span class="comment"># S盒；将8个S盒组成一个8行64列的2维数组</span></span><br><span class="line">S = [S1, S2, S3, S4, S5, S6, S7, S8]</span><br><span class="line"><span class="comment"># P盒置换将每一位输入位映射到输出位。任何一位都不能被映射两次，也不能被略去。</span></span><br><span class="line"><span class="comment"># P盒</span></span><br><span class="line">P_table = [<span class="number">16</span>, <span class="number">7</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">           <span class="number">29</span>, <span class="number">12</span>, <span class="number">28</span>, <span class="number">17</span>,</span><br><span class="line">           <span class="number">1</span>, <span class="number">15</span>, <span class="number">23</span>, <span class="number">26</span>,</span><br><span class="line">           <span class="number">5</span>, <span class="number">18</span>, <span class="number">31</span>, <span class="number">10</span>,</span><br><span class="line">           <span class="number">2</span>, <span class="number">8</span>, <span class="number">24</span>, <span class="number">14</span>,</span><br><span class="line">           <span class="number">32</span>, <span class="number">27</span>, <span class="number">3</span>, <span class="number">9</span>,</span><br><span class="line">           <span class="number">19</span>, <span class="number">13</span>, <span class="number">30</span>, <span class="number">6</span>,</span><br><span class="line">           <span class="number">22</span>, <span class="number">11</span>, <span class="number">4</span>, <span class="number">25</span></span><br><span class="line">           ]</span><br><span class="line"><span class="comment"># 压缩置换表1，不考虑每字节的第8位，将64位密钥减至56位。然后进行一次密钥置换。</span></span><br><span class="line"><span class="comment"># 忽略第8位奇偶校验的同时，进行置换，</span></span><br><span class="line">compressed_table1 = [<span class="number">57</span>, <span class="number">49</span>, <span class="number">41</span>, <span class="number">33</span>, <span class="number">25</span>, <span class="number">17</span>, <span class="number">9</span>,</span><br><span class="line">                <span class="number">1</span>, <span class="number">58</span>, <span class="number">50</span>, <span class="number">42</span>, <span class="number">34</span>, <span class="number">26</span>, <span class="number">18</span>,</span><br><span class="line">                <span class="number">10</span>, <span class="number">2</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">43</span>, <span class="number">35</span>, <span class="number">27</span>,</span><br><span class="line">                <span class="number">19</span>, <span class="number">11</span>, <span class="number">3</span>, <span class="number">60</span>, <span class="number">52</span>, <span class="number">44</span>, <span class="number">36</span>,</span><br><span class="line">                <span class="number">63</span>, <span class="number">55</span>, <span class="number">47</span>, <span class="number">39</span>, <span class="number">31</span>, <span class="number">23</span>, <span class="number">15</span>,</span><br><span class="line">                <span class="number">7</span>, <span class="number">62</span>, <span class="number">54</span>, <span class="number">46</span>, <span class="number">38</span>, <span class="number">30</span>, <span class="number">22</span>,</span><br><span class="line">                <span class="number">14</span>, <span class="number">6</span>, <span class="number">61</span>, <span class="number">53</span>, <span class="number">45</span>, <span class="number">37</span>, <span class="number">29</span>,</span><br><span class="line">                <span class="number">21</span>, <span class="number">13</span>, <span class="number">5</span>, <span class="number">28</span>, <span class="number">20</span>, <span class="number">12</span>, <span class="number">4</span></span><br><span class="line">                ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 压缩置换表2，用于将循环左移和右移后的56bit密钥压缩为48bit</span></span><br><span class="line"><span class="comment"># 完成左移和右移后</span></span><br><span class="line"><span class="comment"># 去掉第9、18、22、25、35、38、43、54位，从56位变成48位，再按表的位置置换。</span></span><br><span class="line">compressed_table2 = [<span class="number">14</span>, <span class="number">17</span>, <span class="number">11</span>, <span class="number">24</span>, <span class="number">1</span>, <span class="number">5</span>,</span><br><span class="line">                <span class="number">3</span>, <span class="number">28</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">21</span>, <span class="number">10</span>,</span><br><span class="line">                <span class="number">23</span>, <span class="number">19</span>, <span class="number">12</span>, <span class="number">4</span>, <span class="number">26</span>, <span class="number">8</span>,</span><br><span class="line">                <span class="number">16</span>, <span class="number">7</span>, <span class="number">27</span>, <span class="number">20</span>, <span class="number">13</span>, <span class="number">2</span>,</span><br><span class="line">                <span class="number">41</span>, <span class="number">52</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">47</span>, <span class="number">55</span>,</span><br><span class="line">                <span class="number">30</span>, <span class="number">40</span>, <span class="number">51</span>, <span class="number">45</span>, <span class="number">33</span>, <span class="number">48</span>,</span><br><span class="line">                <span class="number">44</span>, <span class="number">49</span>, <span class="number">39</span>, <span class="number">56</span>, <span class="number">34</span>, <span class="number">53</span>,</span><br><span class="line">                <span class="number">46</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">36</span>, <span class="number">29</span>, <span class="number">32</span></span><br><span class="line">                ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 扩展置换改变了位的次序，重复了某些位</span></span><br><span class="line"><span class="comment"># 用于对数据进行扩展置换，将32bit数据扩展为48bit</span></span><br><span class="line"><span class="comment"># 目的A:产生与秘钥相同长度的数据以进行异或运算，R0是32位，子秘钥是48位，</span></span><br><span class="line"><span class="comment"># 目的B:提供更长的结果，使得在替代运算时能够进行压缩。</span></span><br><span class="line">extend_table = [<span class="number">32</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,</span><br><span class="line">                <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>,</span><br><span class="line">                <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>,</span><br><span class="line">                <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>,</span><br><span class="line">                <span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>, <span class="number">21</span>,</span><br><span class="line">                <span class="number">20</span>, <span class="number">21</span>, <span class="number">22</span>, <span class="number">23</span>, <span class="number">24</span>, <span class="number">25</span>,</span><br><span class="line">                <span class="number">24</span>, <span class="number">25</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">28</span>, <span class="number">29</span>,</span><br><span class="line">                <span class="number">28</span>, <span class="number">29</span>, <span class="number">30</span>, <span class="number">31</span>, <span class="number">32</span>, <span class="number">1</span></span><br><span class="line">                ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># --------------------------从字符到bit--------------------------</span></span><br><span class="line"><span class="comment"># 将字符转换为对应的Unicode码，中文用2个字节表示</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">char2unicode_ascii</span>(<span class="params">toBeProcessed, length</span>):</span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        <span class="comment"># ord是chr()的及配对函数，以‘c’“c”做为参数</span></span><br><span class="line">        <span class="comment"># 返回对应的ASCII或Unicode数值，若超出，返回TypeError</span></span><br><span class="line">        result.append(<span class="built_in">ord</span>(toBeProcessed[i]))</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将Unicode码转为bit</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unicode2bit</span>(<span class="params">toBeProcessed, length</span>):</span><br><span class="line">    resultBit = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length * <span class="number">16</span>):</span><br><span class="line">        <span class="comment"># 每一位Unicode都是16bit组成</span></span><br><span class="line">        <span class="comment"># 2bProcessed[int(i/16)]length*16:对应待处理文本中的每一个Unicode，进行16次操作</span></span><br><span class="line">        <span class="comment"># 每轮操作右移0,1,2...,15位，然后与1且运算，一次得到16bit</span></span><br><span class="line">        <span class="comment"># ！！！得到的这16位resultBit是个逆序</span></span><br><span class="line">        resultBit.append(toBeProcessed[<span class="built_in">int</span>(i / <span class="number">16</span>)] &gt;&gt; (i % <span class="number">16</span>) &amp; <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> resultBit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将8位ASCII码转为bit</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">byte2bit</span>(<span class="params">charToBeProcessed, length</span>):</span><br><span class="line">    resultBit = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length * <span class="number">8</span>):</span><br><span class="line">        <span class="comment"># 原理同上</span></span><br><span class="line">        resultBit.append(charToBeProcessed[<span class="built_in">int</span>(i / <span class="number">8</span>)] &gt;&gt; (i % <span class="number">8</span>) &amp; <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> resultBit</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># --------------------------从bit到字符--------------------------</span></span><br><span class="line"><span class="comment"># 将bit转为Unicode码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bit2unicode</span>(<span class="params">bitToBeProcessed, length</span>):</span><br><span class="line">    out = []</span><br><span class="line">    temp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        <span class="comment"># 这和上面是同步的，将bit，反着求出，刚刚好</span></span><br><span class="line">        <span class="comment"># 或的运算符在这里相当+，左边是int，右边是int，这里相当于二进制数，妙</span></span><br><span class="line">        <span class="comment"># 每16位bit，对应着一位Unicode，</span></span><br><span class="line">        <span class="comment"># 所以当i对16求模，余数为15时</span></span><br><span class="line">        <span class="comment"># 将append(temp),并且重新设置temp为0</span></span><br><span class="line">        temp = temp | (bitToBeProcessed[i] &lt;&lt; (i % <span class="number">16</span>))</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">16</span> == <span class="number">15</span>:</span><br><span class="line">            out.append(temp)</span><br><span class="line">            temp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将bit转为ascii码</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bit2byte</span>(<span class="params">bitToBeProcessed, length</span>):</span><br><span class="line">    out = []</span><br><span class="line">    temp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        temp = temp | (bitToBeProcessed[i] &lt;&lt; (i % <span class="number">8</span>))</span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">8</span> == <span class="number">7</span>:</span><br><span class="line">            out.append(temp)</span><br><span class="line">            temp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将unicode码转为字符（中文或英文）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unicode2char</span>(<span class="params">byteToBeProcessed, length</span>):</span><br><span class="line">    out = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        out = out + <span class="built_in">chr</span>(byteToBeProcessed[i])</span><br><span class="line">    <span class="keyword">return</span> out</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ------------------生成每一轮的key------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createKeys</span>(<span class="params">keyToBeProcessed</span>):</span><br><span class="line">    keyResult = []</span><br><span class="line">    <span class="comment"># 将char型秘钥转化为bit型</span></span><br><span class="line">    key_ascii_ver = char2unicode_ascii(keyToBeProcessed, <span class="built_in">len</span>(keyToBeProcessed))</span><br><span class="line">    initialKey = byte2bit(key_ascii_ver, <span class="built_in">len</span>(key_ascii_ver))</span><br><span class="line">    <span class="comment"># print(&quot;initialKey = &quot;, end = &#x27;&#x27;)</span></span><br><span class="line">    <span class="comment"># print(initialKey)</span></span><br><span class="line">    <span class="comment"># 用0初始化列表key0，key1,</span></span><br><span class="line">    key0 = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">56</span>)]</span><br><span class="line">    key1 = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>)]</span><br><span class="line">    <span class="comment"># 进行密码压缩置换1，</span></span><br><span class="line">    <span class="comment"># 用压缩置换表1，不考虑每字节的第8位，</span></span><br><span class="line">    <span class="comment"># 将64位密码压缩为56位</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">56</span>):</span><br><span class="line">        key0[i] = initialKey[compressed_table1[i] - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 进行16轮的密码生成</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        <span class="comment"># ---------------确定左移的次数---------------</span></span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span> <span class="keyword">or</span> i == <span class="number">1</span> <span class="keyword">or</span> i == <span class="number">8</span> <span class="keyword">or</span> i == <span class="number">15</span>:</span><br><span class="line">            movestep = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            movestep = <span class="number">2</span></span><br><span class="line">        <span class="comment"># --------------------------------------------</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># -----分两部分，每28bit位一部分，进行循环左移-----</span></span><br><span class="line">        <span class="comment"># 因为每次循环左移就是第28个移动至第1个</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(movestep):</span><br><span class="line">            <span class="comment"># 以行为单位</span></span><br><span class="line">            <span class="comment"># 移动2位就是，移动一位进行2次操作</span></span><br><span class="line">            <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            for k in range(8):</span></span><br><span class="line"><span class="string">                #以行为单位左移</span></span><br><span class="line"><span class="string">                #除去最后一位，每一行都左移一位，操作前保留第一位</span></span><br><span class="line"><span class="string">                temp = key0[k*7]</span></span><br><span class="line"><span class="string">                for m in range(7*k, 7*k + 6):</span></span><br><span class="line"><span class="string">                    key0[m] = key0[m+1]</span></span><br><span class="line"><span class="string">                key0[7*k + 6] = temp</span></span><br><span class="line"><span class="string">            &#x27;&#x27;&#x27;</span></span><br><span class="line">            <span class="comment"># 以组为单位左移</span></span><br><span class="line">            temp = key0[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">27</span>):</span><br><span class="line">                key0[k] = key0[k + <span class="number">1</span>]</span><br><span class="line">            key0[<span class="number">27</span>] = temp</span><br><span class="line">            temp = key0[<span class="number">28</span>]</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">28</span>, <span class="number">55</span>):</span><br><span class="line">                key0[k] = key0[k + <span class="number">1</span>]</span><br><span class="line">            key0[<span class="number">55</span>] = temp</span><br><span class="line">        <span class="comment"># -----------------------------------------------</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># -------对56位密钥进行压缩置换，压缩为48位--------</span></span><br><span class="line">        <span class="comment"># 置换选择表2(PC-2)，得到子密匙K1</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">            key1[k] = key0[compressed_table2[k] - <span class="number">1</span>]</span><br><span class="line">        <span class="comment"># keyResult为16行48列的二维数组</span></span><br><span class="line">        keyResult.extend(key1)</span><br><span class="line">        <span class="comment"># -------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> keyResult</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># 用来检验代码</span></span><br><span class="line"><span class="string">key0 = [57,49,41,33,25,17,9,</span></span><br><span class="line"><span class="string">        1,58,50,42,34,26,18,</span></span><br><span class="line"><span class="string">        10,2,59,51,43,35,27,</span></span><br><span class="line"><span class="string">        19,11,3,60,52,44,36,</span></span><br><span class="line"><span class="string">        63,55,47,39,31,23,15,</span></span><br><span class="line"><span class="string">        7,62,54,46,38,30,22,</span></span><br><span class="line"><span class="string">        14,6,61,53,45,37,29,</span></span><br><span class="line"><span class="string">        21,13,5,28,20,12,4]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 以组为单位左移</span></span><br><span class="line"><span class="string">temp = key0[0]</span></span><br><span class="line"><span class="string">for k in range(27):</span></span><br><span class="line"><span class="string">    key0[k] = key0[k+1]</span></span><br><span class="line"><span class="string">key0[27] = temp</span></span><br><span class="line"><span class="string">temp = key0[28]</span></span><br><span class="line"><span class="string">for k in range(28, 55):</span></span><br><span class="line"><span class="string">    key0[k] = key0[k+1]</span></span><br><span class="line"><span class="string">key0[55] = temp</span></span><br><span class="line"><span class="string">key0</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">DES</span>(<span class="params">text, key, optionType</span>):</span><br><span class="line">    keyResult = createKeys(key)</span><br><span class="line">    <span class="comment"># 初始化最终得到的结果</span></span><br><span class="line">    finalTextOfBit = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line">    finalTextOfUnicode = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印出来检验一下</span></span><br><span class="line">    <span class="comment"># print(keyResult)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> optionType == <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># 初始化</span></span><br><span class="line">        <span class="comment"># 用于临时盛放IP拟置换前，将L部分和R部分合成64的结果</span></span><br><span class="line">        tempText = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 初始化</span></span><br><span class="line">        <span class="comment"># 用于盛放R部分的扩展到48位的结果</span></span><br><span class="line">        extendR = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>)]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># char型向bit型转化</span></span><br><span class="line">        unicodeText = char2unicode_ascii(text, <span class="built_in">len</span>(text))</span><br><span class="line">        <span class="comment"># print(unicodeText)</span></span><br><span class="line">        bitText = unicode2bit(unicodeText, <span class="built_in">len</span>(unicodeText))</span><br><span class="line">        <span class="comment"># print(bitText)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 初始化</span></span><br><span class="line">        <span class="comment"># 用于存放IP置换之后的结果</span></span><br><span class="line">        initTrans = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ---------------进行初始IP置换---------------</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            initTrans[i] = bitText[IP_table[i] - <span class="number">1</span>]</span><br><span class="line">        <span class="comment"># 将64位明文分为左右两部分</span></span><br><span class="line"></span><br><span class="line">        L = initTrans[:<span class="number">32</span>]</span><br><span class="line">        R = initTrans[<span class="number">32</span>:]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 开始进行16轮运算</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">            <span class="comment"># 临时存放R</span></span><br><span class="line">            tempR = R</span><br><span class="line"></span><br><span class="line">            <span class="comment"># -------对R进行扩展，将32位扩展为48位-------</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">                extendR[j] = R[extend_table[j] - <span class="number">1</span>]</span><br><span class="line">            <span class="comment"># print(len(keyResult))</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 第i轮的秘钥，从keyResult中取出</span></span><br><span class="line">            key_i = [keyResult[j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i * <span class="number">48</span>, i * <span class="number">48</span> + <span class="number">48</span>)]</span><br><span class="line">            <span class="comment"># print(i,key_i)</span></span><br><span class="line">            <span class="comment"># ---------与key进行异或运算--------</span></span><br><span class="line">            <span class="comment"># 初始化</span></span><br><span class="line">            XORResult = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>)]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">                <span class="keyword">if</span> key_i[j] != extendR[j]:</span><br><span class="line">                    XORResult[j] = <span class="number">1</span></span><br><span class="line">            <span class="comment"># ----------------------------------</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># ---------开始进行盒运算----------</span></span><br><span class="line">            <span class="comment"># 初始化</span></span><br><span class="line">            SResult = [<span class="number">0</span> <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">                <span class="comment"># 此处使用移位转进制</span></span><br><span class="line">                row = ((XORResult[k * <span class="number">6</span>]) &lt;&lt; <span class="number">1</span>) | (XORResult[k * <span class="number">6</span> + <span class="number">5</span>])</span><br><span class="line">                column = <span class="number">0</span></span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line">                    column = column | (XORResult[k * <span class="number">6</span> + j] &lt;&lt; (<span class="number">4</span> - j))</span><br><span class="line">                temp = S[k][row * <span class="number">16</span> + column]</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                    SResult[k * <span class="number">4</span> + m] = (temp &gt;&gt; m) &amp; <span class="number">1</span></span><br><span class="line">            <span class="comment"># ---------------------------------</span></span><br><span class="line">            <span class="comment"># if i == 0:</span></span><br><span class="line">            <span class="comment">#    print(&#x27;PResult is :;；：&#x27;,PResult)</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># -------------开始进行P盒置换-------------</span></span><br><span class="line">            <span class="comment"># 初始化</span></span><br><span class="line">            PResult = [<span class="number">0</span> <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">                PResult[k] = SResult[P_table[k] - <span class="number">1</span>]</span><br><span class="line">            <span class="comment"># -----------------------------------------</span></span><br><span class="line">            <span class="comment"># if i == 0:</span></span><br><span class="line">            <span class="comment"># print(&#x27;PRsult is :;；：&#x27;,PResult)</span></span><br><span class="line">            <span class="comment"># --------------与L部分的数据进行异或------------</span></span><br><span class="line">            XORWithL = [<span class="number">0</span> <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">                <span class="keyword">if</span> L[k] != PResult[k]:</span><br><span class="line">                    XORWithL[k] = <span class="number">1</span></span><br><span class="line">            <span class="comment"># ----------------------------------------------</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 将临时保存的R部分值，即tempR复制给L</span></span><br><span class="line">            L = tempR</span><br><span class="line">            R = XORWithL</span><br><span class="line"></span><br><span class="line">            <span class="comment"># print(&quot;当前i为%d&quot;,(i))</span></span><br><span class="line">            <span class="comment"># print(&quot;当前L,R为&quot;,L,R)</span></span><br><span class="line">            <span class="comment"># -----------------循环结束-----------------</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 交换左右两部分</span></span><br><span class="line">        L, R = R, L</span><br><span class="line">        <span class="comment"># if i == 0:</span></span><br><span class="line">        <span class="comment">#    print(&#x27;LRis :;；：&#x27;,L,R)</span></span><br><span class="line">        <span class="comment"># 合并为一部分</span></span><br><span class="line">        tempText = L</span><br><span class="line">        tempText.extend(R)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># IP逆置换</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            finalTextOfBit[k] = tempText[_IP_table[k] - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># bit型转化为char型</span></span><br><span class="line">        finalTextOfUnicode = bit2byte(finalTextOfBit, <span class="built_in">len</span>(finalTextOfBit))</span><br><span class="line">        <span class="comment"># print(finalTextOfUnicode)</span></span><br><span class="line">        <span class="comment"># print(&quot;finalTextOfUnicode&quot;, finalTextOfUnicode)</span></span><br><span class="line">        finalTextOfChar = unicode2char(finalTextOfUnicode, <span class="built_in">len</span>(finalTextOfUnicode))</span><br><span class="line">        <span class="keyword">return</span> finalTextOfChar</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># 初始化</span></span><br><span class="line">        <span class="comment"># 用于临时盛放IP拟置换前，将L部分和R部分合成64的结果</span></span><br><span class="line">        tempText = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 初始化</span></span><br><span class="line">        <span class="comment"># 用于盛放R部分的扩展到48位的结果</span></span><br><span class="line">        extendR = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>)]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># char型向bit型转化</span></span><br><span class="line">        unicodeText = char2unicode_ascii(text, <span class="built_in">len</span>(text))</span><br><span class="line">        <span class="comment"># print(unicodeText)</span></span><br><span class="line">        bitText = byte2bit(unicodeText, <span class="built_in">len</span>(unicodeText))</span><br><span class="line">        <span class="comment"># print(bitText)</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 初始化</span></span><br><span class="line">        <span class="comment"># 用于存放IP置换之后的结果</span></span><br><span class="line">        initTrans = [<span class="number">0</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ---------------进行初始IP置换---------------</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            initTrans[i] = bitText[IP_table[i] - <span class="number">1</span>]</span><br><span class="line">        <span class="comment"># 将64位明文分为左右两部分</span></span><br><span class="line">        L = [initTrans[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">        R = [initTrans[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">64</span>)]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 开始进行16轮运算</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            <span class="comment"># 临时存放R</span></span><br><span class="line">            tempR = R</span><br><span class="line"></span><br><span class="line">            <span class="comment"># -------对R进行扩展，将32位扩展为48位-------</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">                extendR[j] = R[extend_table[j] - <span class="number">1</span>]</span><br><span class="line">            <span class="comment"># print(len(keyResult))</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 第i轮的秘钥，从keyResult中取出</span></span><br><span class="line">            key_i = [keyResult[j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i * <span class="number">48</span>, i * <span class="number">48</span> + <span class="number">48</span>)]</span><br><span class="line">            <span class="comment"># ---------与key进行异或运算--------</span></span><br><span class="line">            <span class="comment"># 初始化</span></span><br><span class="line">            XORResult = [<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>)]</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">48</span>):</span><br><span class="line">                <span class="keyword">if</span> key_i[j] != extendR[j]:</span><br><span class="line">                    XORResult[j] = <span class="number">1</span></span><br><span class="line">            <span class="comment"># ----------------------------------</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># ---------开始进行S盒运算----------</span></span><br><span class="line">            <span class="comment"># 初始化</span></span><br><span class="line">            SResult = [<span class="number">0</span> <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">                <span class="comment"># 此处使用移位转进制</span></span><br><span class="line">                row = (XORResult[k * <span class="number">6</span>] &lt;&lt; <span class="number">1</span>) | (XORResult[k * <span class="number">6</span> + <span class="number">5</span>])</span><br><span class="line">                column = <span class="number">0</span></span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line">                    column = column | (XORResult[k * <span class="number">6</span> + j] &lt;&lt; (<span class="number">4</span> - j))</span><br><span class="line">                temp = S[k][row * <span class="number">16</span> + column]</span><br><span class="line">                <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                    SResult[k * <span class="number">4</span> + m] = (temp &gt;&gt; m) &amp; <span class="number">1</span></span><br><span class="line">            <span class="comment"># ---------------------------------</span></span><br><span class="line">            <span class="comment"># print(&#x27;SResult&#x27;,SResult)</span></span><br><span class="line">            <span class="comment"># -------------开始进行P盒置换-------------</span></span><br><span class="line">            <span class="comment"># 初始化</span></span><br><span class="line">            PResult = [<span class="number">0</span> <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">                PResult[k] = SResult[P_table[k] - <span class="number">1</span>]</span><br><span class="line">            <span class="comment"># -----------------------------------------</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># --------------与L部分的数据进行异或------------</span></span><br><span class="line">            XORWithL = [<span class="number">0</span> <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)]</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">                <span class="keyword">if</span> L[k] != PResult[k]:</span><br><span class="line">                    XORWithL[k] = <span class="number">1</span></span><br><span class="line">            <span class="comment"># ----------------------------------------------</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 将临时保存的R部分值，即tempR复制给L</span></span><br><span class="line">            L = tempR</span><br><span class="line">            R = XORWithL</span><br><span class="line">            <span class="comment"># print(&quot;L, R在第%d轮&quot;,(i, L,R))</span></span><br><span class="line">        <span class="comment"># 交换左右两部分</span></span><br><span class="line">        L, R = R, L</span><br><span class="line">        <span class="comment"># print(&quot;L, R&quot;,(L,R))</span></span><br><span class="line">        <span class="comment"># 合并为一部分</span></span><br><span class="line">        tempText = L</span><br><span class="line">        tempText.extend(R)</span><br><span class="line">        <span class="comment"># ----------------------IP逆置换----------------------</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">            finalTextOfBit[k] = tempText[_IP_table[k] - <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># bit型转化为char型</span></span><br><span class="line">        finalTextOfUnicode = bit2unicode(finalTextOfBit, <span class="built_in">len</span>(finalTextOfBit))</span><br><span class="line">        <span class="comment"># print(finalTextOfUnicode)</span></span><br><span class="line">        finalTextOfChar = unicode2char(finalTextOfUnicode, <span class="built_in">len</span>(finalTextOfUnicode))</span><br><span class="line">        <span class="comment"># print(finalTextOfChar)</span></span><br><span class="line">        <span class="keyword">return</span> finalTextOfChar</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="运行结果-4">运行结果</h4>
<p>根据上方算法设计输入输出，并运行该程序。以利用八位密钥“<code>DESCrypt</code>”加密文本“<code>Hello DES</code>”为例，得到加解密情况如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/DESSS.png"></img></p>
<p>显然解密得到的文本与加密前一致。</p>
<h3 id="实验心得-2">实验心得</h3>
<p>作为一个已经有了完整体系且至今仍受欢迎的加密算法，DES加密算法的代码量非常大。为了降低转码的工作量，选取了中英文字母都占2个字节的Unicode作为文本处理后的第一步。</p>
<h2 id="实验三-非对称加密（RSA）实验">实验三 非对称加密（RSA）实验</h2>
<p><strong>实验目的</strong>：了解并掌握RSA加密算法的原理。</p>
<p><strong>实验内容</strong>：自行选取语言编写算法，使该算法在不利用该语言自带密码库的情况下能够对文本进行RSA加解密。</p>
<h3 id="实验原理-5">实验原理</h3>
<p>RSA加密算法是一种非对称加密算法，在公开密钥加密和电子商业中被广泛使用。</p>
<h4 id="公私钥">公私钥</h4>
<p>若Alice想要接收Bob的私人訊息，她可以用以下的方式來产生公钥和私钥：</p>
<ol>
<li>选取任意两个较大且不相等的质数<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span></span></span></span><br>
和<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br>
，<br>
并计算<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mi>p</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">N=pq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">pq</span></span></span></span><br>
。</li>
<li>根据欧拉函数求<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>r</mi><mo>=</mo><mi>φ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo><mo>=</mo><mi>φ</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>×</mo><mi>φ</mi><mo stretchy="false">(</mo><mi>q</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r=\varphi (N) = \varphi (p)\times\varphi (q)=(p-1)(q-1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">φ</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>任取一个小于<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>且与之互质的整数<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span><br>
，并求<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span><br>
关于<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span><br>
的取模倒数<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span></li>
</ol>
<p>通过此方法得到的数对<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>N</mi><mo separator="true">,</mo><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(N,e)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">e</span><span class="mclose">)</span></span></span></span><br>
即公钥，<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>N</mi><mo separator="true">,</mo><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(N,d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span><br>
即私钥。Alice自己保留私钥的同时将公钥发送给Bob即可开始使用非对称算法的加密信息传送。</p>
<h4 id="信息加（解）密">信息加（解）密</h4>
<p>假设Bob想在知晓Alice生成的<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span><br>
和<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">e</span></span></span></span><br>
的情况下给Alice发送消息<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span><br>
，则Bob只需要将<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span><br>
中的每一个字通过unicode或其他转码方式转换为一个小于<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span><br>
的非负整数<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span><br>
，随后通过公式</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>=</mo><msup><mi>n</mi><mi>e</mi></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">c = n^e \bmod{N}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7144em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span></span></p>
<p>将信息<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span><br>
加密为密文<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span><br>
，再将<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span><br>
发送即可。Alice收到消息后解密的方式也类似，只需要利用<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span><br>
和她的私钥<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">d</span></span></span></span><br>
通过公式</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>n</mi><mo>=</mo><msup><mi>c</mi><mi>d</mi></msup><mtext> </mtext><mo lspace="0.22em" rspace="0.22em"><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow></mo><mtext> </mtext><mi>N</mi></mrow><annotation encoding="application/x-tex">n = c^d \bmod {N}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span></span></p>
<p>得到原文<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span><br>
即可。</p>
<p>显然可以证明</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd class ="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>c</mi><mi>d</mi></msup><mo>≡</mo><msup><mi>n</mi><mrow><mi>e</mi><mo>⋅</mo><mi>d</mi></mrow></msup><mtext> </mtext><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mtext> </mtext><mi>N</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>≡</mo><mo>&lt;</mo><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mo>&gt;</mo><msup><mi>n</mi><mrow><mi>e</mi><mi>d</mi></mrow></msup><mo>=</mo><msup><mi>n</mi><mrow><mn>1</mn><mo>+</mo><mi>h</mi><mi>φ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>n</mi><mo>⋅</mo><msup><mi>n</mi><mrow><mi>h</mi><mi>φ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>n</mi><msup><mrow><mo fence="true">(</mo><msup><mi>n</mi><mrow><mi>φ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow></msup><mo fence="true">)</mo></mrow><mi>h</mi></msup></mrow></mstyle></mtd><mtd class ="mtr-glue"></mtd><mtd class ="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
c^d \equiv n^{e \cdot d}\ (\mathrm{mod}\ N)

&amp;\equiv &lt;math&gt; n ^ {ed} = n ^ {1 + h \varphi(N)} = n \cdot n ^ {h \varphi(N) } = n \left( n ^ {\varphi(N)} \right) ^ h
\end{align}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.339em;vertical-align:-0.9195em;"></span><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4195em;"><span style="top:-3.4195em;"><span class="pstrut" style="height:3.389em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight">⋅</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace"> </span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">mod</span></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9195em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4195em;"><span style="top:-3.4195em;"><span class="pstrut" style="height:3.389em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">ma</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">φ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">φ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">φ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.389em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9195em;"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4195em;"><span style="top:-3.4195em;"><span class="pstrut" style="height:3.389em;"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9195em;"><span></span></span></span></span></span></span></span></span></p>
<p>若<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span><br>
与<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span><br>
互质，则由欧拉定理显然有</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>n</mi><mrow><mi>e</mi><mi>d</mi></mrow></msup><mo>≡</mo><mi>n</mi><msup><mrow><mo fence="true">(</mo><msup><mi>n</mi><mrow><mi>φ</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></mrow></msup><mo fence="true">)</mo></mrow><mi>h</mi></msup><mo>≡</mo><mi>n</mi><mo stretchy="false">(</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>h</mi></msup><mo>≡</mo><mi>n</mi><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n ^ {ed} \equiv n \left( n ^ {\varphi(N)} \right) ^ h \equiv n (1) ^ h \equiv n \pmod{N} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.039em;vertical-align:-0.65em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">φ</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.389em;"><span style="top:-3.6029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mord mathnormal">n</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">h</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></span></p>
<p>否则不妨设<br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>p</mi><mi>h</mi><mo separator="true">,</mo><mi>e</mi><mi>d</mi><mo>−</mo><mn>1</mn><mo>=</mo><mi>k</mi><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n = ph, ed -1 = k(q-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><br>
，进而有</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>n</mi><mrow><mi>e</mi><mi>d</mi></mrow></msup><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mi>h</mi><msup><mo stretchy="false">)</mo><mrow><mi>e</mi><mi>d</mi></mrow></msup><mo>≡</mo><mn>0</mn><mo>≡</mo><mi>p</mi><mi>h</mi><mo>≡</mo><mi>n</mi><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n ^ {ed} = (ph) ^ {ed} \equiv 0 \equiv ph \equiv n \pmod p 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>n</mi><mrow><mi>e</mi><mi>d</mi></mrow></msup><mo>=</mo><msup><mi>n</mi><mrow><mi>e</mi><mi>d</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>n</mi><mo>=</mo><msup><mi>n</mi><mrow><mi>k</mi><mo stretchy="false">(</mo><mi>q</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mi>n</mi><mo>=</mo><mo stretchy="false">(</mo><msup><mi>n</mi><mrow><mi>q</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mo stretchy="false">)</mo><mi>k</mi></msup><mi>n</mi><mo>≡</mo><msup><mn>1</mn><mi>k</mi></msup><mi>n</mi><mo>≡</mo><mi>n</mi><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n ^ {ed} = n ^{ed - 1} n = n^{k(q - 1)} n = (n^{q - 1})^k n \equiv 1^k n \equiv n \pmod{q} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.938em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1491em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span></span></p>
<p>故</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>n</mi><mrow><mi>e</mi><mi>d</mi></mrow></msup><mo>≡</mo><mi>n</mi><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333em"/><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n ^ {ed} \equiv n \pmod N
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8991em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.3333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></span></p>
<h3 id="实验代码与运行结果-2">实验代码与运行结果</h3>
<p>利用语言<code>kotlin</code>编写算法如下。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> kotlin.random.Random</span><br><span class="line"></span><br><span class="line"><span class="comment">// Functions of Mathematical Methods</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">euclid4GCDPlus</span><span class="params">(a: <span class="type">Int</span>, b: <span class="type">Int</span>)</span></span>: Triple&lt;<span class="built_in">Int</span>, <span class="built_in">Int</span>, <span class="built_in">Int</span>&gt; &#123;</span><br><span class="line">    <span class="comment">//Extended Euclid Methods are used to search for a solution to the equation ax+by=1.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">if</span> (b == <span class="number">0</span>) &#123;</span><br><span class="line">        Triple(<span class="number">1</span>, <span class="number">0</span>, a)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">val</span> (x, y, euclidResult) = euclid4GCDPlus(b, a % b)</span><br><span class="line">        Triple(y, x - (a / b) * y, euclidResult)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">euclid4GCD</span><span class="params">(a: <span class="type">Int</span>, b: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">    <span class="comment">//Euclid Methods are employed to find the greatest common divisor of 2 numbers</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">if</span> (a % b == <span class="number">0</span>) &#123;</span><br><span class="line">        b</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        euclid4GCD(b, a % b)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">montgomeryModularMultiplication4Mod</span><span class="params">(base: <span class="type">Int</span>, exponent: <span class="type">Int</span>, n: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">    <span class="comment">//Montgomery Modular Multiplication Methods are applied for calculate the mod for an exponential number.</span></span><br><span class="line">    <span class="keyword">val</span> binArray = exponent.toString(<span class="number">2</span>).reversed()</span><br><span class="line">    <span class="keyword">val</span> r = binArray.length</span><br><span class="line">    <span class="keyword">val</span> baseArray = mutableListOf&lt;<span class="built_in">Int</span>&gt;()</span><br><span class="line">    <span class="keyword">var</span> preBase = base</span><br><span class="line">    baseArray.add(preBase)</span><br><span class="line">    repeat(r - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">val</span> nextBase = (preBase * preBase) % n</span><br><span class="line">        baseArray.add(nextBase)</span><br><span class="line">        preBase = nextBase</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> result = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> baseArray.indices) &#123;</span><br><span class="line">        <span class="keyword">if</span> (binArray[i] == <span class="string">&#x27;0&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        &#125;</span><br><span class="line">        result *= baseArray[i]</span><br><span class="line">        result %= n</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result % n</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Functions for cipher</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">keyPairGenerator</span><span class="params">(p: <span class="type">Int</span>, q: <span class="type">Int</span>)</span></span>: Pair&lt;Pair&lt;<span class="built_in">Int</span>, <span class="built_in">Int</span>&gt;, Pair&lt;<span class="built_in">Int</span>, <span class="built_in">Int</span>&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">val</span> n = p * q</span><br><span class="line">    <span class="keyword">val</span> phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    <span class="comment">//Private key</span></span><br><span class="line">    <span class="keyword">var</span> prK = Random.nextInt(<span class="number">2</span>, phi)</span><br><span class="line">    <span class="comment">//Public key</span></span><br><span class="line">    <span class="keyword">var</span> puK = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> (puK == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (euclid4GCD(prK, phi) == <span class="number">1</span>) &#123;</span><br><span class="line">            puK = euclid4GCDPlus(prK, phi).first % phi</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            prK = Random.nextInt(<span class="number">2</span>, phi)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Pair(Pair(n, prK), Pair(n, puK))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">isPrime</span><span class="params">(n: <span class="type">Int</span>)</span></span>: <span class="built_in">Boolean</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> <span class="number">2.</span>.n / <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">class</span> <span class="title class_">RSACipher</span>(keyPair: Pair&lt;<span class="built_in">Int</span>, <span class="built_in">Int</span>&gt;) &#123;</span><br><span class="line">    <span class="keyword">val</span> n = keyPair.first</span><br><span class="line">    <span class="keyword">val</span> key = keyPair.second</span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">encrypt</span><span class="params">(c: <span class="type">List</span>&lt;<span class="type">Int</span>&gt;)</span></span>: List&lt;<span class="built_in">Int</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> c.map &#123; montgomeryModularMultiplication4Mod(it, key, n) &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">fun</span> <span class="title">decrypt</span><span class="params">(e: <span class="type">List</span>&lt;<span class="type">Int</span>&gt;)</span></span>: List&lt;<span class="built_in">Int</span>&gt; &#123;</span><br><span class="line">        <span class="keyword">return</span> e.map &#123; montgomeryModularMultiplication4Mod(it, key, n) &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">encode2Integer</span><span class="params">(text: <span class="type">String</span>)</span></span>: List&lt;<span class="built_in">Int</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> text.map &#123; it.code &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">decode2Character</span><span class="params">(list: <span class="type">List</span>&lt;<span class="type">Int</span>&gt;)</span></span>: String &#123;</span><br><span class="line">    <span class="keyword">return</span> list.map &#123; it.toChar() &#125;.joinToString(<span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">randomPrimeGenerator</span><span class="params">(x: <span class="type">Int</span>)</span></span>: <span class="built_in">Int</span> &#123;</span><br><span class="line">    <span class="keyword">val</span> newNum = Random.nextInt(x)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">if</span> (isPrime(newNum)) &#123;</span><br><span class="line">        newNum</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        randomPrimeGenerator(x)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据上述代码设计输入输出如下。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//Prime Number Prompt</span></span><br><span class="line">    println(<span class="string">&quot;Please select 2 PRIME numbers for key pair generation.&quot;</span>)</span><br><span class="line">    print(<span class="string">&quot;First PRIME number: &quot;</span>)</span><br><span class="line">    <span class="keyword">var</span> p = readln().toInt()</span><br><span class="line">    print(<span class="string">&quot;Second PRIME number: &quot;</span>)</span><br><span class="line">    <span class="keyword">var</span> q = readln().toInt()</span><br><span class="line">    println(<span class="string">&quot;Confirmed. p = <span class="variable">$p</span>, q = <span class="variable">$q</span>&quot;</span>)</span><br><span class="line">    <span class="comment">//Prime check</span></span><br><span class="line">    println(<span class="string">&quot;Checking whether p &amp; q are PRIME...&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> (isPrime(p) &amp;&amp; isPrime(q)) &#123;</span><br><span class="line">        println(<span class="string">&quot;Checked: BOTH PRIME&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isPrime(q)) &#123;</span><br><span class="line">        println(<span class="string">&quot;Checked: p is NOT PRIME&quot;</span>)</span><br><span class="line">        p = randomPrimeGenerator(p)</span><br><span class="line">        println(<span class="string">&quot;Correction：p has been changed to be a PRIME.&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (isPrime(p)) &#123;</span><br><span class="line">        println(<span class="string">&quot;Checked: q is NOT PRIME&quot;</span>)</span><br><span class="line">        q = randomPrimeGenerator(q)</span><br><span class="line">        println(<span class="string">&quot;Correction: q has been changed to be a PRIME.&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        println(<span class="string">&quot;Checked: NO PRIMES&quot;</span>)</span><br><span class="line">        p = randomPrimeGenerator(p)</span><br><span class="line">        q = randomPrimeGenerator(q)</span><br><span class="line">        println(<span class="string">&quot;Correction: p and q has been changed to be PRIME.&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    println(<span class="string">&quot;Check finished. (p = <span class="variable">$p</span>, q = <span class="variable">$q</span>)&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> (privateKeyPair, publicKeyPair) = keyPairGenerator(p, q)</span><br><span class="line">    <span class="keyword">val</span> encryptService = RSACipher(privateKeyPair)</span><br><span class="line">    <span class="keyword">val</span> decryptService = RSACipher(publicKeyPair)</span><br><span class="line">    print(<span class="string">&quot;Enter text to be processed: &quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> message = readln()</span><br><span class="line">    println(<span class="string">&quot;Gotcha. Transcode in progress.&quot;</span>)</span><br><span class="line">    Thread.sleep(<span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">val</span> transcodeText = encode2Integer(message)</span><br><span class="line">    println(<span class="string">&quot;Transcode finished: <span class="variable">$transcodeText</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> (transcodeText.max() &gt; p * q) &#123;</span><br><span class="line">        println(<span class="string">&quot;WARNING: p &amp; q is not great enough. The result may NOT be correct.&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    println(<span class="string">&quot;Encryption in progress.&quot;</span>)</span><br><span class="line">    Thread.sleep(<span class="number">1000</span>)</span><br><span class="line">    <span class="keyword">val</span> encryptedCodeList = encryptService.encrypt(transcodeText)</span><br><span class="line">    println(<span class="string">&quot;Encryption done: <span class="variable">$encryptedCodeList</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> decodedEncrypt = decode2Character(encryptedCodeList)</span><br><span class="line">    println(<span class="string">&quot;Which can be translated into text: <span class="variable">$decodedEncrypt</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> (encryptedCodeList.max() &gt; p * q) &#123;</span><br><span class="line">        println(<span class="string">&quot;WARNING: p &amp; q is not great enough. The result may NOT be correct.&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    println(<span class="string">&quot;Decryption in progress.&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> decryptedCodeList = decryptService.decrypt(encryptedCodeList)</span><br><span class="line">    println(<span class="string">&quot;Decryption done: <span class="variable">$decryptedCodeList</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> decodedDecrypt = decode2Character(decryptedCodeList)</span><br><span class="line">    println(<span class="string">&quot;Decryption done: <span class="variable">$decodedDecrypt</span>&quot;</span>)</span><br><span class="line">    println(<span class="string">&quot;&lt;Private Key Pair: <span class="variable">$privateKeyPair</span>, Public Key Pair: <span class="variable">$publicKeyPair</span>&gt;&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行该程序。以利用质数41、281加密明文“<code>Hello RSA</code>”为例，运行结果如下图所示：</p>
<img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/RSASS.png" />
<p>显然解密结果与原文一致。</p>
<h3 id="实验心得-3">实验心得</h3>
<p>根据RSA实验原理定义，对极大整数做因数分解的难度决定了RSA算法的可靠性——对一极大整数做因数分解愈困难，RSA算法愈可靠；如若后期有人能够找到一种快速分解质因数的算法，那么用RSA加密的信息的可靠性就会骤降。</p>
<h2 id="实验四-MD5加密实验">实验四 MD5加密实验</h2>
<p><strong>实验目的</strong>：了解并掌握哈希加密算法的工作方式。</p>
<p><strong>实验内容</strong>：自行选择语言编写算法，使该算法在不利用该语言自带密码库的情况下可以实现对文本的MD5加密。</p>
<h3 id="实验原理-6">实验原理</h3>
<p>MD5消息摘要算法是一种被广泛使用的密码散列函数，可以通过求余、调整长度等方式产生一个特定长度的的散列值来确定信息传输始末内容的完整性和一致性。经过程序流程，MD5加密算法可以生成四个32位数据，最后联合起来成为一个128-bits散列。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo separator="true">,</mo><mi>Z</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>X</mi><mo>∧</mo><mi>Y</mi><mo stretchy="false">)</mo><mo>∨</mo><mo stretchy="false">(</mo><mi mathvariant="normal">¬</mi><mi>X</mi><mo>∧</mo><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(X,Y,Z) = (X\wedge{Y}) \vee (\neg{X} \wedge{Z})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">¬</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo separator="true">,</mo><mi>Z</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>X</mi><mo>∧</mo><mi>Z</mi><mo stretchy="false">)</mo><mo>∨</mo><mo stretchy="false">(</mo><mi>Y</mi><mo>∧</mo><mi mathvariant="normal">¬</mi><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">G(X,Y,Z) = (X\wedge{Z}) \vee (Y \wedge \neg{Z})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">¬</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo separator="true">,</mo><mi>Z</mi><mo stretchy="false">)</mo><mo>=</mo><mi>X</mi><mo>⊕</mo><mi>Y</mi><mo>⊕</mo><mi>Z</mi></mrow><annotation encoding="application/x-tex">H(X,Y,Z) = X \oplus Y \oplus Z
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>X</mi><mo separator="true">,</mo><mi>Y</mi><mo separator="true">,</mo><mi>Z</mi><mo stretchy="false">)</mo><mo>=</mo><mi>Y</mi><mo>⊕</mo><mo stretchy="false">(</mo><mi>X</mi><mo>∨</mo><mi mathvariant="normal">¬</mi><mi>Z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I(X,Y,Z) = Y \oplus (X \vee \neg{Z})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⊕</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∨</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">¬</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span></span><span class="mclose">)</span></span></span></span></span></p>
<h3 id="实验代码与加密结果">实验代码与加密结果</h3>
<p>通过<code>python</code>编写的加密程式如下所示。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义常量，用于初始化128位变量，注意字节顺序，文中的A=0x01234567，这里低值存放低字节，即01 23 45 67，所以运算时A=0x67452301，其他类似。</span></span><br><span class="line"><span class="comment"># 这里用字符串的形势，是为了和hex函数的输出统一，hex(10)输出为&#x27;0xA&#x27;,注意结果为字符串。</span></span><br><span class="line">hexStrA = <span class="string">&#x27;0x67452301&#x27;</span></span><br><span class="line">hexStrB = <span class="string">&#x27;0xefcdab89&#x27;</span></span><br><span class="line">hexStrC = <span class="string">&#x27;0x98badcfe&#x27;</span></span><br><span class="line">hexStrD = <span class="string">&#x27;0x10325476&#x27;</span></span><br><span class="line"><span class="comment"># 定义每轮中用到的函数。L为循环左移，注意左移之后可能会超过32位，所以要和0xffffffff做与运算，确保结果为32位。</span></span><br><span class="line">F = <span class="keyword">lambda</span> x, y, z: ((x &amp; y) | ((~x) &amp; z))</span><br><span class="line">G = <span class="keyword">lambda</span> x, y, z: ((x &amp; z) | (y &amp; (~z)))</span><br><span class="line">H = <span class="keyword">lambda</span> x, y, z: (x ^ y ^ z)</span><br><span class="line">I = <span class="keyword">lambda</span> x, y, z: (y ^ (x | (~z)))</span><br><span class="line">L = <span class="keyword">lambda</span> x, n: (((x &lt;&lt; n) | (x &gt;&gt; (<span class="number">32</span> - n))) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义每轮中循环左移的位数，这里用4个元组表示,用元组是因为速度比列表快。</span></span><br><span class="line">shi_1 = (<span class="number">7</span>, <span class="number">12</span>, <span class="number">17</span>, <span class="number">22</span>) * <span class="number">4</span></span><br><span class="line">shi_2 = (<span class="number">5</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">20</span>) * <span class="number">4</span></span><br><span class="line">shi_3 = (<span class="number">4</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">23</span>) * <span class="number">4</span></span><br><span class="line">shi_4 = (<span class="number">6</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">21</span>) * <span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义每轮中用到的M[i]次序。</span></span><br><span class="line">m_1 = (<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>)</span><br><span class="line">m_2 = (<span class="number">1</span>, <span class="number">6</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">12</span>)</span><br><span class="line">m_3 = (<span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">7</span>, <span class="number">10</span>, <span class="number">13</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">2</span>)</span><br><span class="line">m_4 = (<span class="number">0</span>, <span class="number">7</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">12</span>, <span class="number">3</span>, <span class="number">10</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">6</span>, <span class="number">13</span>, <span class="number">4</span>, <span class="number">11</span>, <span class="number">2</span>, <span class="number">9</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义函数，用来产生常数T[i]，常数有可能超过32位，同样需要&amp;0xffffffff操作。注意返回的是十进制的数。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">constantGenerator</span>(<span class="params">i</span>):</span><br><span class="line">    result = (<span class="built_in">int</span>(<span class="number">4294967296</span> * <span class="built_in">abs</span>(math.sin(i)))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义函数，用来将列表中的元素循环右移。原因是在每轮操作中，先运算A的值，然后是D，C，B，16轮之后右恢复原来顺序，所以只要每次操作第一个元素即可。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift</span>(<span class="params">shift_list</span>):</span><br><span class="line">    shift_list = [shift_list[<span class="number">3</span>], shift_list[<span class="number">0</span>], shift_list[<span class="number">1</span>], shift_list[<span class="number">2</span>]]</span><br><span class="line">    <span class="keyword">return</span> shift_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义主要的函数，参数为当做种子的列表，每轮用到的F，G，H，I，生成的M[]，以及循环左移的位数。该函数完成一轮运算。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5Cipher</span>(<span class="params">fun_list, f, m, shi</span>):</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">global</span> constantGeneratorApplicationTimeCount</span><br><span class="line">    <span class="comment"># 引入全局变量，T(i)是从1到64循环的。</span></span><br><span class="line">    <span class="keyword">while</span> count &lt; <span class="number">16</span>:</span><br><span class="line">        xx = <span class="built_in">int</span>(fun_list[<span class="number">0</span>], <span class="number">16</span>) + f(<span class="built_in">int</span>(fun_list[<span class="number">1</span>], <span class="number">16</span>), <span class="built_in">int</span>(fun_list[<span class="number">2</span>], <span class="number">16</span>), <span class="built_in">int</span>(fun_list[<span class="number">3</span>], <span class="number">16</span>)) + <span class="built_in">int</span>(m[count],</span><br><span class="line">                                                                                                              <span class="number">16</span>) + constantGenerator(</span><br><span class="line">            constantGeneratorApplicationTimeCount)</span><br><span class="line">        xx = xx &amp; <span class="number">0xffffffff</span></span><br><span class="line">        ll = L(xx, shi[count])</span><br><span class="line">        <span class="comment"># fun_list[0] = hex((int(fun_list[1],16) + ll)&amp;(0xffffffff))[:-1]</span></span><br><span class="line">        fun_list[<span class="number">0</span>] = <span class="built_in">hex</span>((<span class="built_in">int</span>(fun_list[<span class="number">1</span>], <span class="number">16</span>) + ll) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">        <span class="comment"># 最后的[:-1]是为了去除类似&#x27;0x12345678L&#x27;最后的&#x27;L&#x27;</span></span><br><span class="line">        fun_list = shift(fun_list)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        constantGeneratorApplicationTimeCount += <span class="number">1</span></span><br><span class="line">        <span class="comment"># print(fun_list)</span></span><br><span class="line">    <span class="keyword">return</span> fun_list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 该函数生成每轮需要的M[]，最后的参数是为了当有很多分组时，进行偏移。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">m16Generator</span>(<span class="params">order, ascii_list, f_offset</span>):</span><br><span class="line">    ii = <span class="number">0</span></span><br><span class="line">    m16 = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">    f_offset = f_offset * <span class="number">64</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> order:</span><br><span class="line">        i = i * <span class="number">4</span></span><br><span class="line">        m16[ii] = <span class="string">&#x27;0x&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join((ascii_list[i + f_offset] + ascii_list[i + <span class="number">1</span> + f_offset] + ascii_list[</span><br><span class="line">            i + <span class="number">2</span> + f_offset] + ascii_list[i + <span class="number">3</span> + f_offset]).split(<span class="string">&#x27;0x&#x27;</span>))</span><br><span class="line">        ii += <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> m16:</span><br><span class="line">        ind = m16.index(c)</span><br><span class="line">        m16[ind] = reverse_hex(c)</span><br><span class="line">    <span class="keyword">return</span> m16</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 翻转十六进制数的顺序：&#x27;0x01234567&#x27; =&gt; &#x27;0x67452301&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_hex</span>(<span class="params">hex_str</span>):</span><br><span class="line">    hex_str = hex_str[<span class="number">2</span>:]</span><br><span class="line">    hex_str_list = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_str), <span class="number">2</span>):</span><br><span class="line">        hex_str_list.append(hex_str[i:i + <span class="number">2</span>])</span><br><span class="line">    hex_str_list.reverse()</span><br><span class="line">    hex_str_result = <span class="string">&#x27;0x&#x27;</span> + <span class="string">&#x27;&#x27;</span>.join(hex_str_list)</span><br><span class="line">    <span class="keyword">return</span> hex_str_result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示结果函数，将最后运算的结果列表进行翻转，合并成字符串的操作。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show_result</span>(<span class="params">f_list</span>):</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    f_list1 = [<span class="number">0</span>] * <span class="number">4</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f_list:</span><br><span class="line">        f_list1[f_list.index(i)] = reverse_hex(i)[<span class="number">2</span>:]</span><br><span class="line">        result = result + f_list1[f_list.index(i)]</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 程序主循环</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    abcd_list = [hexStrA, hexStrB, hexStrC, hexStrD]</span><br><span class="line">    constantGeneratorApplicationTimeCount = <span class="number">1</span></span><br><span class="line">    input_m = <span class="built_in">input</span>(<span class="string">&#x27;MSG&gt;&gt;&gt;&#x27;</span>)</span><br><span class="line">    <span class="comment"># 对每一个输入先添加一个&#x27;0x80&#x27;，即&#x27;10000000&#x27;</span></span><br><span class="line">    ascii_list = <span class="built_in">list</span>((<span class="built_in">map</span>(<span class="built_in">hex</span>, <span class="built_in">map</span>(<span class="built_in">ord</span>, input_m))))</span><br><span class="line">    <span class="comment"># print(&#x27;ascii_list:&#x27;,ascii_list)</span></span><br><span class="line">    msg_length = <span class="built_in">len</span>(ascii_list) * <span class="number">8</span></span><br><span class="line">    ascii_list.append(<span class="string">&#x27;0x80&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 补充0</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">len</span>(ascii_list) * <span class="number">8</span> + <span class="number">64</span>) % <span class="number">512</span> != <span class="number">0</span>:</span><br><span class="line">        ascii_list.append(<span class="string">&#x27;0x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 最后64为存放消息长度，注意长度存放顺序低位在前。</span></span><br><span class="line">    <span class="comment"># 例如，消息为&#x27;a&#x27;，则长度为&#x27;0x0800000000000000&#x27;</span></span><br><span class="line">    msgLength0x = <span class="built_in">hex</span>(msg_length)[<span class="number">2</span>:]</span><br><span class="line">    msgLength0x = <span class="string">&#x27;0x&#x27;</span> + msgLength0x.rjust(<span class="number">16</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">    msgLength0xBigOrder = reverse_hex(msgLength0x)[<span class="number">2</span>:]</span><br><span class="line">    msgLength0xList = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(msgLength0xBigOrder), <span class="number">2</span>):</span><br><span class="line">        msgLength0xList.append(<span class="string">&#x27;0x&#x27;</span> + msgLength0xBigOrder[i:i + <span class="number">2</span>])</span><br><span class="line">    ascii_list.extend(msgLength0xList)</span><br><span class="line">    <span class="comment"># print  (ascii_list)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对每个分组进行4轮运算</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ascii_list) // <span class="number">64</span>):</span><br><span class="line">        <span class="comment"># 将最初128位种子存放在变量中，</span></span><br><span class="line">        aa, bb, cc, dd = abcd_list</span><br><span class="line">        <span class="comment"># 根据顺序产生每轮M[]列表</span></span><br><span class="line">        order_1 = m16Generator(m_1, ascii_list, i)</span><br><span class="line">        order_2 = m16Generator(m_2, ascii_list, i)</span><br><span class="line">        order_3 = m16Generator(m_3, ascii_list, i)</span><br><span class="line">        order_4 = m16Generator(m_4, ascii_list, i)</span><br><span class="line">        <span class="comment"># 主要四轮运算，注意打印结果列表已经被进行过右移操作！</span></span><br><span class="line">        abcd_list = md5Cipher(abcd_list, F, order_1, shi_1)</span><br><span class="line">        abcd_list = md5Cipher(abcd_list, G, order_2, shi_2)</span><br><span class="line">        abcd_list = md5Cipher(abcd_list, H, order_3, shi_3)</span><br><span class="line">        abcd_list = md5Cipher(abcd_list, I, order_4, shi_4)</span><br><span class="line">        <span class="comment"># 将最后输出与最初128位种子相加，注意，最初种子不能直接使用abcd_list[0]等，因为abcd_list已经被改变</span></span><br><span class="line">        output_a = <span class="built_in">hex</span>((<span class="built_in">int</span>(abcd_list[<span class="number">0</span>], <span class="number">16</span>) + <span class="built_in">int</span>(aa, <span class="number">16</span>)) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">        output_b = <span class="built_in">hex</span>((<span class="built_in">int</span>(abcd_list[<span class="number">1</span>], <span class="number">16</span>) + <span class="built_in">int</span>(bb, <span class="number">16</span>)) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">        output_c = <span class="built_in">hex</span>((<span class="built_in">int</span>(abcd_list[<span class="number">2</span>], <span class="number">16</span>) + <span class="built_in">int</span>(cc, <span class="number">16</span>)) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">        output_d = <span class="built_in">hex</span>((<span class="built_in">int</span>(abcd_list[<span class="number">3</span>], <span class="number">16</span>) + <span class="built_in">int</span>(dd, <span class="number">16</span>)) &amp; <span class="number">0xffffffff</span>)</span><br><span class="line">        <span class="comment"># 将输出放到列表中，作为下一次128位种子</span></span><br><span class="line">        abcd_list = [output_a, output_b, output_c, output_d]</span><br><span class="line">        <span class="comment"># 将全局变量Ti_count恢复，一遍开始下一个分组的操作。</span></span><br><span class="line">        constantGeneratorApplicationTimeCount = <span class="number">1</span></span><br><span class="line">        <span class="comment"># 最后调用函数，格式化输出</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;MD5&gt;&gt;&gt;&#x27;</span> + show_result(abcd_list))</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>运行该程序。以加密文本“<code>hello md5</code>”为例，得到散列值如下所示：</p>
<img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/mdSS1.png" />
<p>在其他网站上使用在线md5加密工具，加密同一个文本，得到的散列值与之相同。</p>
<img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/mdSS2.png" />
<p>因此，编写的算法是正确的。</p>
<h3 id="实验心得-4">实验心得</h3>
<p>MD5作为验证被传输信息完整性和一致性的散列值生成方式，其算法也很难被模仿出来，因此代码量也非常的大。在16进制与10进制数相互转换的时候很容易因为疏忽而错转漏转。</p>
<h2 id="实验五-密码学应用·文件加密传输试验">实验五 密码学应用·文件加密传输试验</h2>
<p><strong>实验目的</strong>：掌握对称加密、非对称加密和哈希算法生成散列值的使用场景并能灵活应用这三种加密方法。</p>
<h3 id="实验内容">实验内容</h3>
<p>自选语言编写代码文件若干，使这些程式在不借助这些语言自带密码库的情况下能够模拟文件的加密传输与解密且保证满足信息传输的诸多基本要求（如不可否认性、完整性等）。标注清楚发送端需要发送的文件和这些文件的产生方式，并说明接收端接收到的文件和之后的处理方式。发送的文件须打包发送。</p>
<h3 id="功能实现">功能实现</h3>
<p>根据实验内容主要考虑以下几个方面。加密算法的代码在前文均已提及，为减少篇幅在此不与呈现。</p>
<h4 id="机制">机制</h4>
<p>文件传输最经典的应用莫过于电子邮箱。因此类比电子邮箱的操作，可以将收发信两端简单模拟成一个个人电子邮箱中的<code>sent</code>（已发送）和<code>inbox</code>（收件箱）两个文件夹。注意到实验内容要求对文件进行打包发送，因此考虑电子邮箱中的<code>outbox</code>（待发送）文件夹——其将暂时存储加密之后的文件，在所有文件生成完毕后询问用户是否确定发送（类似于邮件的“确认发送倒计时”操作）。完成发送后，<code>outbox</code>中的文件将全部转移至<code>sent</code>中；如若用户在这一环节取消发送，<code>outbox</code>中的所有文件将会被销毁。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## fileTransmit.py ##</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">shutil.rmtree(<span class="string">r&#x27;inbox&#x27;</span>)</span><br><span class="line">os.makedirs(<span class="string">&#x27;inbox&#x27;</span>)</span><br><span class="line">willingness = <span class="built_in">input</span>(<span class="string">&quot;Are you sure to send all files in the outbox?\nNO(0)/YES(1)&gt;&gt;&gt; &quot;</span>)</span><br><span class="line"><span class="keyword">if</span> willingness == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Sending&quot;</span>, end=<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&gt;&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br><span class="line">    shutil.move(<span class="string">&#x27;outbox/encrypted_hash.txt&#x27;</span>, <span class="string">r&#x27;sent/encrypted_hash.txt&#x27;</span>)</span><br><span class="line">    shutil.move(<span class="string">&#x27;outbox/encrypted_msg.txt&#x27;</span>, <span class="string">r&#x27;sent/encrypted_msg.txt&#x27;</span>)</span><br><span class="line">    shutil.move(<span class="string">&#x27;outbox/encrypted_pwd_des.txt&#x27;</span>, <span class="string">r&#x27;sent/encrypted_pwd_des.txt&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\rPack sent.&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    os.unlink(<span class="string">r&#x27;outbox/encrypted_hash.txt&#x27;</span>)</span><br><span class="line">    os.unlink(<span class="string">r&#x27;outbox/encrypted_msg.txt&#x27;</span>)</span><br><span class="line">    os.unlink(<span class="string">r&#x27;outbox/encrypted_pwd_des.txt&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>此外，注意到收发信两端还可能需要用到的非对称加密，另需要一位作为管理者（<code>keyProvider</code>）的角色为他们分发各自的公私钥。考虑到私钥需要二人自行保管，<code>keyProvider</code>会将私钥<code>private_key_sender.txt</code>和<code>private_key_receiver.txt</code>置于双方各自的沙盒<code>sandbox_sender</code>和<code>sandbox_receiver</code>中作为隔离，公钥<code>public_key_sender.txt</code>和<code>public_key_receiver.txt</code>则将放置在公共空间中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">individualized_key_pair_generator</span>(<span class="params">client</span>):</span><br><span class="line">    p = random_prime(<span class="number">100</span>, <span class="number">200</span>)</span><br><span class="line">    q = random_prime(<span class="number">200</span>, <span class="number">300</span>)</span><br><span class="line">    private_rsa_key_pair, public_rsa_key_pair = generate_key_pair(p, q)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;public_key_&#123;&#125;.txt&#x27;</span>.<span class="built_in">format</span>(client), <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> client_pub_key:</span><br><span class="line">        client_pub_key.write(<span class="built_in">str</span>(public_rsa_key_pair))</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;sandbox_&#123;&#125;/private_key_&#123;&#125;.txt&quot;</span>.<span class="built_in">format</span>(client, client), <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> client_private_key:</span><br><span class="line">        client_private_key.write(<span class="built_in">str</span>(private_rsa_key_pair))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Key pair for &#123;&#125; generated. &lt;&lt;p = &#123;&#125;, q = &#123;&#125;&gt;&gt;&quot;</span>.<span class="built_in">format</span>(client, p, q))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">individualized_key_pair_generator(<span class="string">&#x27;sender&#x27;</span>)</span><br><span class="line">individualized_key_pair_generator(<span class="string">&#x27;receiver&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>因此整个实验过程应须要<code>inbox</code>、<code>outbox</code>、<code>sent</code>、<code>sandbox_receiver</code>、<code>sandbox_sender</code>五个文件夹。在实验每次模拟开始前，可以对这些文件夹进行适当的初始化，便于在实验进行过程中查看每一步的变化：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Python file to initialize the overall progress of the file transmit</span></span><br><span class="line"><span class="comment"># Finished May 31 2:20 p.m.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">does_not_exist</span>(<span class="params">directory_path</span>):</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(directory_path):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">not_empty_dir</span>(<span class="params">directory_path</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(os.listdir(directory_path)) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> does_not_exist(<span class="string">&#x27;inbox&#x27;</span>):</span><br><span class="line">    os.mkdir(<span class="string">&#x27;inbox&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> does_not_exist(<span class="string">&#x27;outbox&#x27;</span>):</span><br><span class="line">    os.mkdir(<span class="string">&#x27;outbox&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> does_not_exist(<span class="string">&#x27;sent&#x27;</span>):</span><br><span class="line">    os.mkdir(<span class="string">&#x27;sent&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> does_not_exist(<span class="string">&#x27;sandbox_receiver&#x27;</span>):</span><br><span class="line">    os.mkdir(<span class="string">&#x27;sandbox_receiver&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> not_empty_dir(<span class="string">&#x27;inbox&#x27;</span>):</span><br><span class="line">    shutil.rmtree(<span class="string">r&#x27;inbox&#x27;</span>)</span><br><span class="line">    os.mkdir(<span class="string">r&#x27;inbox&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> not_empty_dir(<span class="string">&#x27;sent&#x27;</span>):</span><br><span class="line">    shutil.rmtree(<span class="string">r&#x27;sent&#x27;</span>)</span><br><span class="line">    os.mkdir(<span class="string">r&#x27;sent&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> not_empty_dir(<span class="string">&#x27;outbox&#x27;</span>):</span><br><span class="line">    shutil.rmtree(<span class="string">r&#x27;outbox&#x27;</span>)</span><br><span class="line">    os.mkdir(<span class="string">r&#x27;outbox&#x27;</span>)</span><br><span class="line"></span><br><span class="line">os.unlink(<span class="string">&#x27;public_key_sender.txt&#x27;</span>)</span><br><span class="line">os.unlink(<span class="string">&#x27;public_key_receiver.txt&#x27;</span>)</span><br><span class="line">os.unlink(<span class="string">&#x27;sandbox_sender/private_key_sender.txt&#x27;</span>)</span><br><span class="line">os.unlink(<span class="string">&#x27;sandbox_receiver/private_key_receiver.txt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Initialization Complete&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="发送方">发送方</h4>
<p>发送方显然是消息的撰写者和整个流程的开端。他需要对自己撰写的信息进行加密，并且对此次加密所使用的密码也进行加密。随后，他还需要对这两个加密之后的内容都生成散列值，然后对这一散列值进行加密进行发送。为保安全，这三个文件使用同一个加密方式进行加密显然是不行的；加之需要考虑信息传输的基本安全要求，故可分别利用对称加密密钥、发送方非对称加密私钥和接收方对称加密公钥按如下方式进行加密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">message_encrypt()</span><br><span class="line">des_key_encrypt_with_rsa()</span><br><span class="line">signature()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Compulsory files packed. Check them in the outbox.&quot;</span>)</span><br></pre></td></tr></table></figure>
<ol>
<li>使用对称加密密钥对信息进行加密，确保文件的机密性（对称加密密钥和信息明文<code>sample.txt</code>可以直接存储在<code>sandbox_sender</code>中）；<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">message_encrypt</span>():</span><br><span class="line">    encrypted_lines = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sandbox_sender/desPassword.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> des_password_gotcha:</span><br><span class="line">        des_pwd = des_password_gotcha.readline()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sandbox_sender/sample.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> original_file:</span><br><span class="line">        original = original_file.read()</span><br><span class="line">    original_length = <span class="built_in">len</span>(original)</span><br><span class="line">    <span class="keyword">if</span> original_length % <span class="number">4</span> != <span class="number">0</span>:</span><br><span class="line">        original = original + <span class="built_in">int</span>(<span class="number">4</span> - (original_length % <span class="number">4</span>)) * <span class="string">&quot; &quot;</span></span><br><span class="line">    original_length = <span class="built_in">len</span>(original)</span><br><span class="line">    encrypted_line = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(original_length / <span class="number">4</span>)):</span><br><span class="line">        temp_text = [original[j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i * <span class="number">4</span>, i * <span class="number">4</span> + <span class="number">4</span>)]</span><br><span class="line">        encrypted_line = <span class="string">&quot;&quot;</span>.join([encrypted_line, DES(temp_text, des_pwd, <span class="number">0</span>)])</span><br><span class="line">    encrypted_lines += <span class="built_in">str</span>(encrypted_line)</span><br><span class="line">    <span class="comment"># print(encrypted_lines)</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;outbox/encrypted_msg.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> container_of_encrypted_contents:</span><br><span class="line">        container_of_encrypted_contents.write(encrypted_lines)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Message has been encrypted.&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li>对加密信息所用的对称加密密钥利用接收方的非对称加密公钥进行加密，使接收方无法否认文件由他接收；<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">des_key_encrypt_with_rsa</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sandbox_sender/desPassword.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> des_password_gotcha:</span><br><span class="line">        des_pwd = des_password_gotcha.readline()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;public_key_receiver.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> pub_key_radio:</span><br><span class="line">        public_key_pair_string = pub_key_radio.readline()</span><br><span class="line">        public_key_pair_string2pair_step_1 = public_key_pair_string.split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">        public_key_pair_string2pair_step_2_a = public_key_pair_string2pair_step_1[<span class="number">0</span>].removeprefix(<span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">        public_key_pair_string2pair_step_2_b = public_key_pair_string2pair_step_1[<span class="number">1</span>].removesuffix(<span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">        public_rsa_key_pair = <span class="built_in">int</span>(public_key_pair_string2pair_step_2_a), <span class="built_in">int</span>(public_key_pair_string2pair_step_2_b)</span><br><span class="line">        rsa_encrypt_service = RSA(public_rsa_key_pair)</span><br><span class="line">        encoded_password = Encode2int(des_pwd)</span><br><span class="line">        encrypted_password = rsa_encrypt_service.Encrypt(encoded_password)</span><br><span class="line">        encrypted_des_pwd_chr = Decode2chr(encrypted_password)</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;outbox/encrypted_pwd_des.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> encrypted_des_pwd_container:</span><br><span class="line">        encrypted_des_pwd_container.write(<span class="built_in">str</span>(encrypted_des_pwd_chr))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;DES password has been encrypted.&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li>对确保信息完整性和一致性的散列值用发送方的非对称加密私钥进行加密作为“签名”，使发送方无法否认文件由他发送。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">signature</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sandbox_sender/private_key_sender.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> private_key_container:</span><br><span class="line">        private_key_pair_string = private_key_container.readline()</span><br><span class="line">    private_key_pair_string2pair_step_1 = private_key_pair_string.split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">    private_key_pair_string2pair_step_2_a = private_key_pair_string2pair_step_1[<span class="number">0</span>].removeprefix(<span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">    private_key_pair_string2pair_step_2_b = private_key_pair_string2pair_step_1[<span class="number">1</span>].removesuffix(<span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">    private_rsa_key_pair = <span class="built_in">int</span>(private_key_pair_string2pair_step_2_a), <span class="built_in">int</span>(private_key_pair_string2pair_step_2_b)</span><br><span class="line">    rsa_encrypt_service = RSA(private_rsa_key_pair)</span><br><span class="line">    encoded_hash = Encode2int(hash_abstract())</span><br><span class="line">    encrypted_hash = rsa_encrypt_service.Encrypt(encoded_hash)</span><br><span class="line">    encrypted_hash_chr = Decode2chr(encrypted_hash)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;outbox/encrypted_hash.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> hash_container_to_send:</span><br><span class="line">         hash_container_to_send.write(<span class="built_in">str</span>(encrypted_hash_chr))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Hash has been signed (encrypted).&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>因此，发送方需要发送的文件显然是加密过后的信息<code>encrypted_msg.txt</code>、加密过后的对称密码<code>encrypted_pwd_des.txt</code>和加密过后的散列值<code>encrypted_hash.txt</code>三个。</p>
<h4 id="接收方">接收方</h4>
<p>根据“发送方”章节中所提到的发送文件清单，接收方应当对这些文件有针对性地进行解密。不难得到他的任务如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">message_decrypt()</span><br><span class="line">hash_decrypt()</span><br><span class="line">hash_check()</span><br></pre></td></tr></table></figure>
<ol>
<li>使用自己的非对称加密私钥对<code>encrypted_pwd_des.txt</code>进行解密，得到对称加密密码，随后凭此密码对<code>encrypted_msg.txt</code>进行解密，得到<code>decrypted_msg.txt</code>； <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">des_pwd_decrypt</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sent/encrypted_pwd_des.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> des_pwd_container:</span><br><span class="line">        des_pwd_encrypted = des_pwd_container.readline()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sandbox_receiver/private_key_receiver.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> prv_key_radio:</span><br><span class="line">        private_key_pair_string = prv_key_radio.readline()</span><br><span class="line">    private_key_pair_string2pair_step_1 = private_key_pair_string.split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">    private_key_pair_string2pair_step_2_a = private_key_pair_string2pair_step_1[<span class="number">0</span>].removeprefix(<span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">    private_key_pair_string2pair_step_2_b = private_key_pair_string2pair_step_1[<span class="number">1</span>].removesuffix(<span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">    private_key_pair = <span class="built_in">int</span>(private_key_pair_string2pair_step_2_a), <span class="built_in">int</span>(private_key_pair_string2pair_step_2_b)</span><br><span class="line">    <span class="comment"># print(public_key_pair_string2pair_step_2_a)</span></span><br><span class="line">    <span class="comment"># print(public_key_pair_string2pair_step_2_b)</span></span><br><span class="line">    rsa_decrypt_service = RSA(private_key_pair)</span><br><span class="line">    encoded_encrypted_des_pwd = Encode2int(des_pwd_encrypted)</span><br><span class="line">    decrypted_encoded_des_pwd = rsa_decrypt_service.Decrypt(encoded_encrypted_des_pwd)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(Decode2chr(decrypted_encoded_des_pwd))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># The function to decrypt the message basing on the symmetric password decrypted (finished May 31 12:13 a.m.)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">message_decrypt</span>():</span><br><span class="line">    decrypted_lines = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sandbox_sender/desPassword.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> des_password_gotcha:</span><br><span class="line">        des_pwd = des_pwd_decrypt()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sent/encrypted_msg.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> encrypted_message_container:</span><br><span class="line">        encrypted_message = encrypted_message_container.readline()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">len</span>(encrypted_message) / <span class="number">8</span>)):</span><br><span class="line">        newTempText = [encrypted_message[j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i * <span class="number">8</span>, i * <span class="number">8</span> + <span class="number">8</span>)]</span><br><span class="line">        decrypted_lines = <span class="string">&quot;&quot;</span>.join([decrypted_lines, DES(newTempText, des_pwd, <span class="number">1</span>)])</span><br><span class="line">    <span class="comment"># print(decrypted_lines)</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;inbox/decrypted_msg.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> container_of_decrypted_contents:</span><br><span class="line">        container_of_decrypted_contents.write(decrypted_lines)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Message Decrypted.&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li>使用发送方的非对称加密公钥对<code>encrypted_hash.txt</code>进行解密，得到明文<code>decrypted_hash.txt</code>。随后自己再生成一次解密后的信息和密码对应的散列值，与<code>decrypted_hash.txt</code>进行比较；如果相同则代表信息在传输途中未被修改。 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">hash_decrypt</span>():</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sent/encrypted_hash.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> hash_receipt:</span><br><span class="line">    encrypted_hash = hash_receipt.readline()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;public_key_sender.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> public_key_sender:</span><br><span class="line">    public_key_sender_string = public_key_sender.readline()</span><br><span class="line">public_key_pair_string2pair_step_1 = public_key_sender_string.split(<span class="string">&#x27;, &#x27;</span>)</span><br><span class="line">public_key_pair_string2pair_step_2_a = public_key_pair_string2pair_step_1[<span class="number">0</span>].removeprefix(<span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">public_key_pair_string2pair_step_2_b = public_key_pair_string2pair_step_1[<span class="number">1</span>].removesuffix(<span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">public_rsa_key_pair = <span class="built_in">int</span>(public_key_pair_string2pair_step_2_a), <span class="built_in">int</span>(public_key_pair_string2pair_step_2_b)</span><br><span class="line">rsa_decrypt_service = RSA(public_rsa_key_pair)</span><br><span class="line">encoded_hash = Encode2int(encrypted_hash)</span><br><span class="line">encrypted_hash = rsa_decrypt_service.Decrypt(encoded_hash)</span><br><span class="line">encrypted_hash_chr = Decode2chr(encrypted_hash)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;inbox/hash_decrypted.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> decrypted_hash:</span><br><span class="line">    decrypted_hash.write(<span class="built_in">str</span>(encrypted_hash_chr))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Hash Decrypted.&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_check</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;inbox/hash_decrypted.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> hash_decrypted:</span><br><span class="line">        hash_received = hash_decrypted.readline()</span><br><span class="line">        hash_received_list = hash_received.split(<span class="string">&quot; &quot;</span>)</span><br><span class="line">    hash_received_1 = hash_received_list[<span class="number">0</span>]</span><br><span class="line">    hash_received_2 = hash_received_list[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sent/encrypted_msg.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> sample:</span><br><span class="line">        message = sample.read()</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;sent/encrypted_pwd_des.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> encrypted_pwd:</span><br><span class="line">        password = encrypted_pwd.readline()</span><br><span class="line">    message_hash = MD5(message)</span><br><span class="line">    message_hash.fill_text()</span><br><span class="line">    message_hash_str = message_hash.group_processing()</span><br><span class="line">    <span class="keyword">if</span> hash_received_1 != message_hash_str:</span><br><span class="line">        <span class="built_in">print</span>(message_hash_str)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;FATAL: Message has been modified half way.&quot;</span>)</span><br><span class="line">    password_hash = MD5(password)</span><br><span class="line">    password_hash.fill_text()</span><br><span class="line">    password_hash_str = password_hash.group_processing()</span><br><span class="line">    <span class="keyword">if</span> hash_received_2 != password_hash_str:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;FATAL: Symmetric password has been modified half way.&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> hash_received_1 == message_hash_str <span class="keyword">and</span> hash_received_2 == password_hash_str:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Message not vandalized. Transmit success.&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="操作记录">操作记录</h3>
<p>根据上述运行一系列程序。首先运行的是<code>initialization.py</code>文件，对整个实验环境进行初始化。初始化完成后的输出结果和文件架构如下图所示；可以看到，目前的文件树只有<code>sandbox_sender</code>中有文件。这两个文件分别是待处理和发送的信息和对称加密密码。</p>
<img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/fcSS1.png" />
<p>随后运行<code>fileCipher_keyProvider.py</code>。运行后的结果如图所示；此时该程式通过随机生成的质数197和239产生了发送方的非对称加密公私钥，并将前者放置在公共空间，将后者放置在<code>sandbox_sender</code>中；类似地，随机生成的质数157和239产生了接收方的非对称加密公私钥，并将前者放置在公共空间，将后者放置在<code>sandbox_receiver</code>中。</p>
<img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/fcSS2.png" />
<p>此时运行<code>fileCipher_sender.py</code>。运行后的结果如图所示；此时文件树已经在<code>outbox</code>中出现了信息、对称密码和散列值加密后的文件。</p>
<img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/fcSS3.png" />
<p>随后运行<code>fileTransmit.py</code>。运行后，<code>outbox</code>中的文件已经全部转移至<code>sent</code>。</p>
<img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/fcSS4.png" />
<p>之后运行<code>fileCipher_receiver.py</code>。运行后，在<code>inbox</code>中得到信息明文和散列值。将信息明文<code>decrypted_msg.txt</code>与原信息<code>sample.txt</code>对比，发现文本内容一致；程式将解密后的散列值文件<code>decrypted_hash.txt</code>中的两段散列值分别与根据解密所得信息和对称加密密码重新生成的散列值进行比较，发现两散列值均一致，故输出信息未被损坏（“Message not vandalized”），进而得到传输成功的结论。</p>
<img src="https://cdn.jsdelivr.net/gh/k-pk66/CRYPTNXDU-X-/IMG/fcSS5.png" />
<h3 id="实验心得-5">实验心得</h3>
<p>实验过程中因为使用<code>python</code>，故不得不使用该语言的文件有关指令。在编写过程中进行调试时发现虽然<code>python</code>可以创建文件但是不能创建文件夹，因此为<code>initialization.py</code>额外增加了确认路径是否存在的操作。</p>
<p>本次实验虽然只进行了两个午后，但加深了我对密码学中比较具有代表性的这些典型加密方式对理解。不难看出，密码之所以“密”，恰因为每时每刻都有机制在进行更新；通过多种加密方式混合使用，可以很大程度上解决并不知道收发信双方约定加/解密顺序的情况下成功破译的潜在隐患。文件加密传输是密码学综合应用的集大成之作；在我们针对此实验集中精力于收发信双方的同时，作为密钥分发者的管理员也起着非常重要的作用。如果分发密钥者没有妥善保管好双方的私钥，纵使收发双方妥善保管了依然存在传输的信息被截获或被篡改的可能。只有整个文件加密传输过程中任何一个节点都能够保证符合流程规定，这个传输的过程才可以确定是安全的。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://k-pk66.github.io">K-PK66</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://k-pk66.github.io/2024/06/24/Kryptographie/">https://k-pk66.github.io/2024/06/24/Kryptographie/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://k-pk66.github.io" target="_blank">雨水磁浮的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%A4%8D%E4%B9%A0%E8%AE%B0/">#复习记#</a></div><div class="post_share"><div class="social-share" data-image="/images/avatar.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-former-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-former-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/06/22/shanghai-2024/" title="仲夏·假日6时间"><img class="cover" src="/2024/06/22/shanghai-2024/IMG_7645.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">仲夏·假日6时间</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/06/19/Softwareingenieurung-2024/" title="课程「软件工程」期末复习笔记"><img class="cover" src="/2024/06/19/Softwareingenieurung-2024/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-19</div><div class="title">课程「软件工程」期末复习笔记</div></div></a></div><div><a href="/2024/06/17/Warteschlangentheorie-2024/" title="课程「随机过程与排队论」期末复习笔记"><img class="cover" src="/2024/06/17/Warteschlangentheorie-2024/cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-06-17</div><div class="title">课程「随机过程与排队论」期末复习笔记</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/images/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">K-PK66</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">12</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/K-PK66" target="_blank" title="Github"><i class="fab fa-github" style="color: #999999;"></i></a><a class="social-icon" href="https://weibo.com/u/7485313545" target="_blank" title="Weibo"><i class="fab fa-weibo" style="color: #999999;"></i></a><a class="social-icon" href="https://www.zhihu.com/people/3a1787aecf6d9d1d42e2d7c93fda3121" target="_blank" title="Zhihu"><i class="fab fa-zhihu" style="color: #999999;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">这个博客站点会记录我生前的见闻。<br />希望我过世后墓碑上能够刻上一个二维码，后人扫开了就是这个站点。<br />网页标志是扫雷的图标是因为我喜欢叫自己“上海局地雷暴雨”。</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">期末复习</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">引言</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">实验报告</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%B8%80-%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E5%AE%9E%E9%AA%8C"><span class="toc-number">2.1.</span> <span class="toc-text">实验一 古典密码实验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Caesar%E5%AF%86%E7%A0%81"><span class="toc-number">2.1.1.</span> <span class="toc-text">Caesar密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%8E%9F%E7%90%86"><span class="toc-number">2.1.1.1.</span> <span class="toc-text">实验原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BB%A3%E7%A0%81%E4%B8%8E%E8%BF%90%E8%A1%8C%E8%AE%B0%E5%BD%95"><span class="toc-number">2.1.1.2.</span> <span class="toc-text">实验代码与运行记录</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">2.1.1.2.1.</span> <span class="toc-text">加密算法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">2.1.1.2.2.</span> <span class="toc-text">运行结果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81"><span class="toc-number">2.1.2.</span> <span class="toc-text">仿射密码</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%8E%9F%E7%90%86-2"><span class="toc-number">2.1.2.1.</span> <span class="toc-text">实验原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BB%A3%E7%A0%81%E4%B8%8E%E8%BF%90%E8%A1%8C%E8%AE%B0%E5%BD%95-2"><span class="toc-number">2.1.2.2.</span> <span class="toc-text">实验代码与运行记录</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E4%BB%A3%E7%A0%81"><span class="toc-number">2.1.2.2.1.</span> <span class="toc-text">算法代码</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%BA%92%E8%B4%A8"><span class="toc-number">2.1.2.2.1.1.</span> <span class="toc-text">互质</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8F%96%E6%A8%A1%E5%80%92%E6%95%B0%EF%BC%88%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83%EF%BC%89"><span class="toc-number">2.1.2.2.1.2.</span> <span class="toc-text">取模倒数（乘法逆元）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86"><span class="toc-number">2.1.2.2.1.3.</span> <span class="toc-text">加密</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C-2"><span class="toc-number">2.1.2.2.2.</span> <span class="toc-text">运行结果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E7%BD%AE%E6%8D%A2%E5%8A%A0%E5%AF%86"><span class="toc-number">2.1.3.</span> <span class="toc-text">单表置换加密</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%8E%9F%E7%90%86-3"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">实验原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BB%A3%E7%A0%81%E4%B8%8E%E8%BF%90%E8%A1%8C%E8%AE%B0%E5%BD%95-3"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">实验代码与运行记录</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E4%BB%A3%E7%A0%81-2"><span class="toc-number">2.1.3.2.1.</span> <span class="toc-text">算法代码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C-3"><span class="toc-number">2.1.3.2.2.</span> <span class="toc-text">运行结果</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%BF%83%E5%BE%97"><span class="toc-number">2.1.4.</span> <span class="toc-text">实验心得</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BA%8C-%E5%AF%B9%E7%A7%B0%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86%EF%BC%88DES%EF%BC%89%E5%AE%9E%E9%AA%8C"><span class="toc-number">2.2.</span> <span class="toc-text">实验二 对称密钥加密（DES）实验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%8E%9F%E7%90%86-4"><span class="toc-number">2.2.1.</span> <span class="toc-text">实验原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BB%A3%E7%A0%81%E4%B8%8E%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">2.2.2.</span> <span class="toc-text">实验代码与运行结果</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AE%97%E6%B3%95%E4%BB%A3%E7%A0%81-3"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">算法代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C-4"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">运行结果</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%BF%83%E5%BE%97-2"><span class="toc-number">2.2.3.</span> <span class="toc-text">实验心得</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%B8%89-%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%EF%BC%88RSA%EF%BC%89%E5%AE%9E%E9%AA%8C"><span class="toc-number">2.3.</span> <span class="toc-text">实验三 非对称加密（RSA）实验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%8E%9F%E7%90%86-5"><span class="toc-number">2.3.1.</span> <span class="toc-text">实验原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%AC%E7%A7%81%E9%92%A5"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">公私钥</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E5%8A%A0%EF%BC%88%E8%A7%A3%EF%BC%89%E5%AF%86"><span class="toc-number">2.3.1.2.</span> <span class="toc-text">信息加（解）密</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BB%A3%E7%A0%81%E4%B8%8E%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C-2"><span class="toc-number">2.3.2.</span> <span class="toc-text">实验代码与运行结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%BF%83%E5%BE%97-3"><span class="toc-number">2.3.3.</span> <span class="toc-text">实验心得</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%9B%9B-MD5%E5%8A%A0%E5%AF%86%E5%AE%9E%E9%AA%8C"><span class="toc-number">2.4.</span> <span class="toc-text">实验四 MD5加密实验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%8E%9F%E7%90%86-6"><span class="toc-number">2.4.1.</span> <span class="toc-text">实验原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BB%A3%E7%A0%81%E4%B8%8E%E5%8A%A0%E5%AF%86%E7%BB%93%E6%9E%9C"><span class="toc-number">2.4.2.</span> <span class="toc-text">实验代码与加密结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%BF%83%E5%BE%97-4"><span class="toc-number">2.4.3.</span> <span class="toc-text">实验心得</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E4%BA%94-%E5%AF%86%E7%A0%81%E5%AD%A6%E5%BA%94%E7%94%A8%C2%B7%E6%96%87%E4%BB%B6%E5%8A%A0%E5%AF%86%E4%BC%A0%E8%BE%93%E8%AF%95%E9%AA%8C"><span class="toc-number">2.5.</span> <span class="toc-text">实验五 密码学应用·文件加密传输试验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9"><span class="toc-number">2.5.1.</span> <span class="toc-text">实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.5.2.</span> <span class="toc-text">功能实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%BA%E5%88%B6"><span class="toc-number">2.5.2.1.</span> <span class="toc-text">机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%91%E9%80%81%E6%96%B9"><span class="toc-number">2.5.2.2.</span> <span class="toc-text">发送方</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A5%E6%94%B6%E6%96%B9"><span class="toc-number">2.5.2.3.</span> <span class="toc-text">接收方</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95"><span class="toc-number">2.5.3.</span> <span class="toc-text">操作记录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E5%BF%83%E5%BE%97-5"><span class="toc-number">2.5.4.</span> <span class="toc-text">实验心得</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-post-series"><div class="item-headline"><i class="fa-solid fa-layer-group"></i><span>西安电子科技大学计算机科学与技术学院计算机科学与技术专业网络信息安全方向课程期末复习笔记（本科）</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/06/17/Warteschlangentheorie-2024/" title="课程「随机过程与排队论」期末复习笔记"><img src="/2024/06/17/Warteschlangentheorie-2024/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="课程「随机过程与排队论」期末复习笔记"></a><div class="content"><a class="title" href="/2024/06/17/Warteschlangentheorie-2024/" title="课程「随机过程与排队论」期末复习笔记">课程「随机过程与排队论」期末复习笔记</a><time datetime="2024-06-17T04:41:29.000Z" title="发表于 2024-06-17 12:41:29">2024-06-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/19/Softwareingenieurung-2024/" title="课程「软件工程」期末复习笔记"><img src="/2024/06/19/Softwareingenieurung-2024/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="课程「软件工程」期末复习笔记"></a><div class="content"><a class="title" href="/2024/06/19/Softwareingenieurung-2024/" title="课程「软件工程」期末复习笔记">课程「软件工程」期末复习笔记</a><time datetime="2024-06-19T08:18:44.000Z" title="发表于 2024-06-19 16:18:44">2024-06-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/24/Kryptographie/" title="课程「应用密码学与网络安全」期末复习笔记">课程「应用密码学与网络安全」期末复习笔记</a><time datetime="2024-06-23T16:51:40.000Z" title="发表于 2024-06-24 00:51:40">2024-06-24</time></div></div></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/06/24/Kryptographie/" title="课程「应用密码学与网络安全」期末复习笔记">课程「应用密码学与网络安全」期末复习笔记</a><time datetime="2024-06-23T16:51:40.000Z" title="发表于 2024-06-24 00:51:40">2024-06-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/22/shanghai-2024/" title="仲夏·假日6时间"><img src="/2024/06/22/shanghai-2024/IMG_7645.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="仲夏·假日6时间"/></a><div class="content"><a class="title" href="/2024/06/22/shanghai-2024/" title="仲夏·假日6时间">仲夏·假日6时间</a><time datetime="2024-06-22T10:19:00.000Z" title="发表于 2024-06-22 18:19:00">2024-06-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/19/Softwareingenieurung-2024/" title="课程「软件工程」期末复习笔记"><img src="/2024/06/19/Softwareingenieurung-2024/cover.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="课程「软件工程」期末复习笔记"/></a><div class="content"><a class="title" href="/2024/06/19/Softwareingenieurung-2024/" title="课程「软件工程」期末复习笔记">课程「软件工程」期末复习笔记</a><time datetime="2024-06-19T08:18:44.000Z" title="发表于 2024-06-19 16:18:44">2024-06-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/17/Warteschlangentheorie-2024/" title="课程「随机过程与排队论」期末复习笔记"><img src="/2024/06/17/Warteschlangentheorie-2024/cover.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="课程「随机过程与排队论」期末复习笔记"/></a><div class="content"><a class="title" href="/2024/06/17/Warteschlangentheorie-2024/" title="课程「随机过程与排队论」期末复习笔记">课程「随机过程与排队论」期末复习笔记</a><time datetime="2024-06-17T04:41:29.000Z" title="发表于 2024-06-17 12:41:29">2024-06-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/06/02/makeRecord/" title="博客创建记录"><img src="/images/TrainsNXAB202309.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="博客创建记录"/></a><div class="content"><a class="title" href="/2024/06/02/makeRecord/" title="博客创建记录">博客创建记录</a><time datetime="2024-06-02T11:00:30.000Z" title="发表于 2024-06-02 19:00:30">2024-06-02</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 By K-PK66</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">中</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/gh/k-pk66/k-pk66.github.io/js/utils.js"></script><script src="https://cdn.jsdelivr.net/gh/k-pk66/k-pk66.github.io/js/main.js"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  const initGitalk = () => {
    const gitalk = new Gitalk(Object.assign({
      clientID: 'Ov23liEks6kU4DCwFX0U',
      clientSecret: 'ac74b4b7009fb7720b75caf9d4768d57b95b227e',
      repo: 'k-pk66.github.io',
      owner: 'k-pk66',
      admin: ['k-pk66'],
      id: 'e94820d34aa2003e0eaa23637070f1e7',
      updateCountCallback: commentCount
    },))

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async() => {
    if (typeof Gitalk === 'function') initGitalk()
    else {
      await getCSS('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.css')
      await getScript('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.js')
      initGitalk()
    }
  }
  
  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="https://cdn.jsdelivr.net/gh/k-pk66/k-pk66.github.io/js/search/local-search.js"></script></div></div><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>